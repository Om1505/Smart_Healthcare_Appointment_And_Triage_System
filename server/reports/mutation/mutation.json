{"files":{"routes/appointments.js":{"language":"javascript","mutants":[{"id":"17","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":51,"line":37},"start":{"column":49,"line":37}}},{"id":"57","mutatorName":"BlockStatement","replacement":"{}","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":14,"line":76},"start":{"column":43,"line":70}}},{"id":"58","mutatorName":"MethodExpression","replacement":"currentSlotTime.toTimeString()","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":78,"line":71},"start":{"column":32,"line":71}}},{"id":"59","mutatorName":"ConditionalExpression","replacement":"true","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":72},"start":{"column":19,"line":72}}},{"id":"60","mutatorName":"ConditionalExpression","replacement":"false","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":72},"start":{"column":19,"line":72}}},{"id":"61","mutatorName":"LogicalOperator","replacement":"slotTime >= block.startTime || slotTime < block.endTime","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":72},"start":{"column":19,"line":72}}},{"id":"62","mutatorName":"ConditionalExpression","replacement":"true","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":46,"line":72},"start":{"column":19,"line":72}}},{"id":"63","mutatorName":"EqualityOperator","replacement":"slotTime > block.startTime","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":46,"line":72},"start":{"column":19,"line":72}}},{"id":"64","mutatorName":"EqualityOperator","replacement":"slotTime < block.startTime","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":46,"line":72},"start":{"column":19,"line":72}}},{"id":"65","mutatorName":"ConditionalExpression","replacement":"true","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":72},"start":{"column":50,"line":72}}},{"id":"66","mutatorName":"EqualityOperator","replacement":"slotTime <= block.endTime","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":72},"start":{"column":50,"line":72}}},{"id":"67","mutatorName":"EqualityOperator","replacement":"slotTime >= block.endTime","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":72},"start":{"column":50,"line":72}}},{"id":"68","mutatorName":"BlockStatement","replacement":"{}","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":16,"line":75},"start":{"column":76,"line":72}}},{"id":"69","mutatorName":"BooleanLiteral","replacement":"false","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":33,"line":73},"start":{"column":29,"line":73}}},{"id":"106","mutatorName":"BlockStatement","replacement":"{}","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":4,"line":117},"start":{"column":39,"line":115}}},{"id":"107","mutatorName":"ObjectLiteral","replacement":"{}","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":76,"line":116},"start":{"column":33,"line":116}}},{"id":"108","mutatorName":"StringLiteral","replacement":"\"\"","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":74,"line":116},"start":{"column":44,"line":116}}},{"id":"270","mutatorName":"StringLiteral","replacement":"\"\"","status":"NoCoverage","static":false,"coveredBy":[],"location":{"end":{"column":90,"line":340},"start":{"column":64,"line":340}}},{"id":"8","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["5"],"location":{"end":{"column":67,"line":23},"start":{"column":35,"line":23}}},{"id":"7","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["5"],"coveredBy":["5"],"location":{"end":{"column":6,"line":24},"start":{"column":18,"line":22}}},{"id":"5","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","5","7","42","43","51","52","54"],"location":{"end":{"column":16,"line":22},"start":{"column":9,"line":22}}},{"id":"4","mutatorName":"BooleanLiteral","replacement":"doctor","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","5","7","42","43","51","52","54"],"location":{"end":{"column":16,"line":22},"start":{"column":9,"line":22}}},{"id":"6","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":6,"killedBy":["5"],"coveredBy":["0","1","2","3","4","5","7","42","43","51","52","54"],"location":{"end":{"column":16,"line":22},"start":{"column":9,"line":22}}},{"id":"9","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["5"],"location":{"end":{"column":65,"line":23},"start":{"column":46,"line":23}}},{"id":"10","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected 'undefined' to be '692a16160db540d83957c0ce' // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["1"],"coveredBy":["0","1","2","3","4","7","42","43","51","52","54"],"location":{"end":{"column":6,"line":29},"start":{"column":55,"line":26}}},{"id":"11","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'upcoming' // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["1"],"coveredBy":["0","1","2","3","4","7","42","43","51","52","54"],"location":{"end":{"column":25,"line":28},"start":{"column":15,"line":28}}},{"id":"12","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["2","54"],"location":{"end":{"column":6,"line":35},"start":{"column":39,"line":32}}},{"id":"13","mutatorName":"StringLiteral","replacement":"``","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["2","54"],"location":{"end":{"column":80,"line":33},"start":{"column":30,"line":33}}},{"id":"14","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":51,"line":37},"start":{"column":26,"line":37}}},{"id":"15","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":51,"line":37},"start":{"column":26,"line":37}}},{"id":"18","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"expected 'Stryker was here' to have property \"date\"","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":30,"line":39},"start":{"column":28,"line":39}}},{"id":"19","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":102,"line":41},"start":{"column":24,"line":41}}},{"id":"16","mutatorName":"LogicalOperator","replacement":"doctor.blockedTimes && []","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":51,"line":37},"start":{"column":26,"line":37}}},{"id":"21","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":5,"killedBy":["4"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":43,"line":41},"start":{"column":35,"line":41}}},{"id":"20","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":33,"line":41},"start":{"column":25,"line":41}}},{"id":"22","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":54,"line":41},"start":{"column":45,"line":41}}},{"id":"23","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":67,"line":41},"start":{"column":56,"line":41}}},{"id":"24","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":79,"line":41},"start":{"column":69,"line":41}}},{"id":"27","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":27,"line":44},"start":{"column":21,"line":44}}},{"id":"26","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":101,"line":41},"start":{"column":91,"line":41}}},{"id":"25","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":89,"line":41},"start":{"column":81,"line":41}}},{"id":"29","mutatorName":"EqualityOperator","replacement":"i >= 14","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":27,"line":44},"start":{"column":21,"line":44}}},{"id":"28","mutatorName":"EqualityOperator","replacement":"i <= 14","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":27,"line":44},"start":{"column":21,"line":44}}},{"id":"31","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":6,"line":88},"start":{"column":34,"line":44}}},{"id":"32","mutatorName":"MethodExpression","replacement":"date.setTime(today.getDate() + i)","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":5,"killedBy":["4"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":40,"line":46},"start":{"column":7,"line":46}}},{"id":"34","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":45,"line":51},"start":{"column":11,"line":51}}},{"id":"35","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":45,"line":51},"start":{"column":11,"line":51}}},{"id":"33","mutatorName":"ArithmeticOperator","replacement":"today.getDate() - i","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":39,"line":46},"start":{"column":20,"line":46}}},{"id":"30","mutatorName":"UpdateOperator","replacement":"i--","statusReason":"Hit limit reached (14001/14000)","status":"Timeout","static":false,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":32,"line":44},"start":{"column":29,"line":44}}},{"id":"36","mutatorName":"LogicalOperator","replacement":"daySchedule || daySchedule.enabled","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":45,"line":51},"start":{"column":11,"line":51}}},{"id":"37","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":8,"line":87},"start":{"column":47,"line":51}}},{"id":"39","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":60,"line":53},"start":{"column":57,"line":53}}},{"id":"42","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":41,"line":59},"start":{"column":16,"line":59}}},{"id":"40","mutatorName":"MethodExpression","replacement":"date.setMinutes(startHour, startMin, 0, 0)","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":76,"line":55},"start":{"column":36,"line":55}}},{"id":"38","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":66,"line":52},"start":{"column":63,"line":52}}},{"id":"41","mutatorName":"MethodExpression","replacement":"date.setMinutes(endHour, endMin, 0, 0)","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":70,"line":56},"start":{"column":34,"line":56}}},{"id":"43","mutatorName":"EqualityOperator","replacement":"currentSlotTime <= endTime","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":41,"line":59},"start":{"column":16,"line":59}}},{"id":"46","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":72,"line":60},"start":{"column":65,"line":60}}},{"id":"44","mutatorName":"EqualityOperator","replacement":"currentSlotTime >= endTime","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":41,"line":59},"start":{"column":16,"line":59}}},{"id":"45","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Hit limit reached (5001/5000)","status":"Timeout","static":false,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":10,"line":86},"start":{"column":43,"line":59}}},{"id":"48","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":28,"line":61},"start":{"column":19,"line":61}}},{"id":"47","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":12,"line":64},"start":{"column":74,"line":60}}},{"id":"49","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":30,"line":62},"start":{"column":21,"line":62}}},{"id":"52","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":32,"line":67},"start":{"column":27,"line":67}}},{"id":"50","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"expected false to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":6,"killedBy":["42"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":25,"line":63},"start":{"column":21,"line":63}}},{"id":"53","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["3","52"],"location":{"end":{"column":12,"line":77},"start":{"column":45,"line":68}}},{"id":"51","mutatorName":"StringLiteral","replacement":"``","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":63,"line":66},"start":{"column":34,"line":66}}},{"id":"54","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["3","52"],"location":{"end":{"column":41,"line":70},"start":{"column":17,"line":70}}},{"id":"55","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["3","52"],"location":{"end":{"column":41,"line":70},"start":{"column":17,"line":70}}},{"id":"56","mutatorName":"EqualityOperator","replacement":"blockDate !== dateString","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["3","52"],"location":{"end":{"column":41,"line":70},"start":{"column":17,"line":70}}},{"id":"71","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":61,"line":78},"start":{"column":15,"line":78}}},{"id":"73","mutatorName":"BooleanLiteral","replacement":"bookedSlots.has(dateTimeString)","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":47,"line":78},"start":{"column":15,"line":78}}},{"id":"70","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":61,"line":78},"start":{"column":15,"line":78}}},{"id":"74","mutatorName":"BooleanLiteral","replacement":"isBlocked","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":61,"line":78},"start":{"column":51,"line":78}}},{"id":"72","mutatorName":"LogicalOperator","replacement":"!bookedSlots.has(dateTimeString) || !isBlocked","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":61,"line":78},"start":{"column":15,"line":78}}},{"id":"75","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 0 to be greater than 0","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":12,"line":83},"start":{"column":63,"line":78}}},{"id":"76","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected {} to have property \"date\"","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":14,"line":82},"start":{"column":33,"line":79}}},{"id":"79","mutatorName":"ArithmeticOperator","replacement":"currentSlotTime.getMinutes() - slotDuration","statusReason":"Hit limit reached (5001/5000)","status":"Timeout","static":false,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":81,"line":85},"start":{"column":38,"line":85}}},{"id":"81","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Server Error' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["6"],"coveredBy":["6","7"],"location":{"end":{"column":40,"line":92},"start":{"column":26,"line":92}}},{"id":"77","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected false to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":7,"killedBy":["43"],"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":60,"line":80},"start":{"column":57,"line":80}}},{"id":"78","mutatorName":"MethodExpression","replacement":"currentSlotTime.setHours(currentSlotTime.getMinutes() + slotDuration)","status":"Survived","static":false,"testsCompleted":10,"coveredBy":["0","1","2","3","4","42","43","51","52","54"],"location":{"end":{"column":82,"line":85},"start":{"column":11,"line":85}}},{"id":"84","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["8"],"coveredBy":["8","9","12","44"],"location":{"end":{"column":38,"line":99},"start":{"column":7,"line":99}}},{"id":"85","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 403 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["9"],"coveredBy":["8","9","12","44"],"location":{"end":{"column":38,"line":99},"start":{"column":7,"line":99}}},{"id":"86","mutatorName":"EqualityOperator","replacement":"req.user.userType === 'patient'","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["8"],"coveredBy":["8","9","12","44"],"location":{"end":{"column":38,"line":99},"start":{"column":7,"line":99}}},{"id":"87","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["8"],"coveredBy":["8","9","12","44"],"location":{"end":{"column":38,"line":99},"start":{"column":29,"line":99}}},{"id":"89","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["9"],"location":{"end":{"column":77,"line":100},"start":{"column":33,"line":100}}},{"id":"90","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["9"],"location":{"end":{"column":75,"line":100},"start":{"column":44,"line":100}}},{"id":"88","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 403 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["9"],"coveredBy":["9"],"location":{"end":{"column":4,"line":101},"start":{"column":40,"line":99}}},{"id":"92","mutatorName":"MethodExpression","replacement":"Appointment.find({\n  patient: req.user.userId\n}).populate('doctor', 'fullName specialization')","statusReason":"expected 200 to be 500 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["12"],"coveredBy":["8","12","44"],"location":{"end":{"column":26,"line":105},"start":{"column":32,"line":103}}},{"id":"93","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":3,"coveredBy":["8","12","44"],"location":{"end":{"column":77,"line":103},"start":{"column":49,"line":103}}},{"id":"94","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["8"],"coveredBy":["8","12","44"],"location":{"end":{"column":25,"line":104},"start":{"column":17,"line":104}}},{"id":"95","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":3,"coveredBy":["8","12","44"],"location":{"end":{"column":52,"line":104},"start":{"column":27,"line":104}}},{"id":"96","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected 1577836800000 to be greater than 1640995200000","status":"Killed","static":false,"testsCompleted":3,"killedBy":["44"],"coveredBy":["8","12","44"],"location":{"end":{"column":25,"line":105},"start":{"column":13,"line":105}}},{"id":"97","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"expected 1577836800000 to be greater than 1640995200000","status":"Killed","static":false,"testsCompleted":3,"killedBy":["44"],"coveredBy":["8","12","44"],"location":{"end":{"column":23,"line":105},"start":{"column":21,"line":105}}},{"id":"99","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Server Error' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["12"],"coveredBy":["12"],"location":{"end":{"column":40,"line":110},"start":{"column":26,"line":110}}},{"id":"3","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","5","6","7","42","43","51","52","54"],"location":{"end":{"column":4,"line":90},"start":{"column":7,"line":19}}},{"id":"2","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["0"],"coveredBy":["0","1","2","3","4","5","6","7","42","43","51","52","54"],"location":{"end":{"column":2,"line":94},"start":{"column":78,"line":18}}},{"id":"102","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":37,"line":115},"start":{"column":7,"line":115}}},{"id":"103","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":37,"line":115},"start":{"column":7,"line":115}}},{"id":"104","mutatorName":"EqualityOperator","replacement":"req.user.userType === 'doctor'","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":37,"line":115},"start":{"column":7,"line":115}}},{"id":"105","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":37,"line":115},"start":{"column":29,"line":115}}},{"id":"110","mutatorName":"MethodExpression","replacement":"Appointment.find({\n  doctor: req.user.userId\n}).populate('patient', 'fullName email') // Get patient details","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":25,"line":121},"start":{"column":32,"line":119}}},{"id":"111","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":76,"line":119},"start":{"column":49,"line":119}}},{"id":"112","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["11"],"coveredBy":["10","11","45","49"],"location":{"end":{"column":26,"line":120},"start":{"column":17,"line":120}}},{"id":"113","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":4,"coveredBy":["10","11","45","49"],"location":{"end":{"column":44,"line":120},"start":{"column":28,"line":120}}},{"id":"114","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected 1672531200000 to be less than or equal to 1640995200000","status":"Killed","static":false,"testsCompleted":3,"killedBy":["45"],"coveredBy":["10","11","45","49"],"location":{"end":{"column":24,"line":121},"start":{"column":13,"line":121}}},{"id":"115","mutatorName":"MethodExpression","replacement":"appointments","statusReason":"expected 1 to be +0 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49"],"location":{"end":{"column":86,"line":124},"start":{"column":31,"line":124}}},{"id":"116","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"expected +0 to be 1 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["11"],"coveredBy":["10","11","45","49"],"location":{"end":{"column":85,"line":124},"start":{"column":51,"line":124}}},{"id":"80","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["6"],"coveredBy":["6","7"],"location":{"end":{"column":4,"line":93},"start":{"column":17,"line":90}}},{"id":"118","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["53"],"location":{"end":{"column":40,"line":129},"start":{"column":26,"line":129}}},{"id":"83","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["8"],"coveredBy":["8","9","12","44"],"location":{"end":{"column":2,"line":112},"start":{"column":68,"line":98}}},{"id":"91","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["8"],"coveredBy":["8","12","44"],"location":{"end":{"column":4,"line":108},"start":{"column":7,"line":102}}},{"id":"122","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 400 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":78,"line":160},"start":{"column":9,"line":160}}},{"id":"123","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 404 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":3,"killedBy":["32"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":78,"line":160},"start":{"column":9,"line":160}}},{"id":"124","mutatorName":"LogicalOperator","replacement":"(!doctorId || !date || !time || !patientNameForVisit) && !primaryReason","statusReason":"expected 404 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":3,"killedBy":["32"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":78,"line":160},"start":{"column":9,"line":160}}},{"id":"98","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["12"],"coveredBy":["12"],"location":{"end":{"column":4,"line":111},"start":{"column":17,"line":108}}},{"id":"125","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":60,"line":160},"start":{"column":9,"line":160}}},{"id":"101","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":2,"line":131},"start":{"column":59,"line":114}}},{"id":"126","mutatorName":"LogicalOperator","replacement":"(!doctorId || !date || !time) && !patientNameForVisit","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":60,"line":160},"start":{"column":9,"line":160}}},{"id":"127","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":36,"line":160},"start":{"column":9,"line":160}}},{"id":"128","mutatorName":"LogicalOperator","replacement":"(!doctorId || !date) && !time","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":36,"line":160},"start":{"column":9,"line":160}}},{"id":"129","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":27,"line":160},"start":{"column":9,"line":160}}},{"id":"130","mutatorName":"LogicalOperator","replacement":"!doctorId && !date","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":27,"line":160},"start":{"column":9,"line":160}}},{"id":"131","mutatorName":"BooleanLiteral","replacement":"doctorId","statusReason":"expected 400 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":18,"line":160},"start":{"column":9,"line":160}}},{"id":"132","mutatorName":"BooleanLiteral","replacement":"date","statusReason":"expected 400 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":27,"line":160},"start":{"column":22,"line":160}}},{"id":"133","mutatorName":"BooleanLiteral","replacement":"time","statusReason":"expected 400 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":36,"line":160},"start":{"column":31,"line":160}}},{"id":"134","mutatorName":"BooleanLiteral","replacement":"patientNameForVisit","statusReason":"expected 400 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":60,"line":160},"start":{"column":40,"line":160}}},{"id":"135","mutatorName":"BooleanLiteral","replacement":"primaryReason","statusReason":"expected 400 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":78,"line":160},"start":{"column":64,"line":160}}},{"id":"136","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 404 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["32"],"coveredBy":["32"],"location":{"end":{"column":6,"line":162},"start":{"column":80,"line":160}}},{"id":"137","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string","status":"Killed","static":false,"testsCompleted":1,"killedBy":["32"],"coveredBy":["32"],"location":{"end":{"column":119,"line":161},"start":{"column":35,"line":161}}},{"id":"138","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to contain 'Missing required fields'","status":"Killed","static":false,"testsCompleted":1,"killedBy":["32"],"coveredBy":["32"],"location":{"end":{"column":117,"line":161},"start":{"column":46,"line":161}}},{"id":"109","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["10"],"coveredBy":["10","11","45","49","53"],"location":{"end":{"column":4,"line":127},"start":{"column":7,"line":118}}},{"id":"140","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 201 to be 409 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["31"],"coveredBy":["30","31","33","34","46"],"location":{"end":{"column":25,"line":169},"start":{"column":15,"line":169}}},{"id":"139","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["30","31","33","34","46"],"location":{"end":{"column":6,"line":170},"start":{"column":59,"line":165}}},{"id":"141","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 409 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","33","46"],"location":{"end":{"column":28,"line":171},"start":{"column":9,"line":171}}},{"id":"142","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 201 to be 409 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["31"],"coveredBy":["30","31","33","46"],"location":{"end":{"column":28,"line":171},"start":{"column":9,"line":171}}},{"id":"143","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 201 to be 409 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["31"],"coveredBy":["31"],"location":{"end":{"column":6,"line":173},"start":{"column":30,"line":171}}},{"id":"144","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string","status":"Killed","static":false,"testsCompleted":1,"killedBy":["31"],"coveredBy":["31"],"location":{"end":{"column":111,"line":172},"start":{"column":35,"line":172}}},{"id":"145","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to contain 'no longer available'","status":"Killed","static":false,"testsCompleted":1,"killedBy":["31"],"coveredBy":["31"],"location":{"end":{"column":109,"line":172},"start":{"column":46,"line":172}}},{"id":"146","mutatorName":"BooleanLiteral","replacement":"doctor","statusReason":"expected 404 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","33","46"],"location":{"end":{"column":16,"line":177},"start":{"column":9,"line":177}}},{"id":"147","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 404 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","33","46"],"location":{"end":{"column":16,"line":177},"start":{"column":9,"line":177}}},{"id":"148","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["33"],"coveredBy":["30","33","46"],"location":{"end":{"column":16,"line":177},"start":{"column":9,"line":177}}},{"id":"149","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["33"],"coveredBy":["33"],"location":{"end":{"column":6,"line":179},"start":{"column":18,"line":177}}},{"id":"150","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Doctor not found.' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["33"],"coveredBy":["33"],"location":{"end":{"column":67,"line":178},"start":{"column":35,"line":178}}},{"id":"151","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Doctor not found.' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["33"],"coveredBy":["33"],"location":{"end":{"column":65,"line":178},"start":{"column":46,"line":178}}},{"id":"152","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 1 to be 300 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","46"],"location":{"end":{"column":44,"line":180},"start":{"column":17,"line":180}}},{"id":"153","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected +0 to be 300 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","46"],"location":{"end":{"column":44,"line":180},"start":{"column":17,"line":180}}},{"id":"154","mutatorName":"LogicalOperator","replacement":"doctor.consultationFee && 0","statusReason":"expected +0 to be 300 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","46"],"location":{"end":{"column":44,"line":180},"start":{"column":17,"line":180}}},{"id":"155","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected 500 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","46"],"location":{"end":{"column":6,"line":206},"start":{"column":44,"line":183}}},{"id":"156","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 201 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","46"],"location":{"end":{"column":31,"line":190},"start":{"column":22,"line":190}}},{"id":"117","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["53"],"coveredBy":["53"],"location":{"end":{"column":4,"line":130},"start":{"column":17,"line":127}}},{"id":"158","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["34"],"location":{"end":{"column":35,"line":212},"start":{"column":19,"line":212}}},{"id":"159","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Server Error' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["34"],"coveredBy":["34"],"location":{"end":{"column":40,"line":213},"start":{"column":26,"line":213}}},{"id":"163","mutatorName":"BooleanLiteral","replacement":"appointment","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","26","27","28","29"],"location":{"end":{"column":21,"line":223},"start":{"column":9,"line":223}}},{"id":"164","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","26","27","28","29"],"location":{"end":{"column":21,"line":223},"start":{"column":9,"line":223}}},{"id":"166","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["27"],"coveredBy":["27"],"location":{"end":{"column":6,"line":225},"start":{"column":23,"line":223}}},{"id":"165","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":3,"killedBy":["27"],"coveredBy":["25","26","27","28","29"],"location":{"end":{"column":21,"line":223},"start":{"column":9,"line":223}}},{"id":"167","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Appointment not found' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["27"],"coveredBy":["27"],"location":{"end":{"column":71,"line":224},"start":{"column":35,"line":224}}},{"id":"168","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Appointment not found' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["27"],"coveredBy":["27"],"location":{"end":{"column":69,"line":224},"start":{"column":46,"line":224}}},{"id":"169","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 401 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","26","28","29"],"location":{"end":{"column":59,"line":226},"start":{"column":9,"line":226}}},{"id":"170","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 200 to be 401 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["26"],"coveredBy":["25","26","28","29"],"location":{"end":{"column":59,"line":226},"start":{"column":9,"line":226}}},{"id":"171","mutatorName":"EqualityOperator","replacement":"appointment.patient.toString() === req.user.userId","statusReason":"expected 401 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","26","28","29"],"location":{"end":{"column":59,"line":226},"start":{"column":9,"line":226}}},{"id":"172","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 200 to be 401 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["26"],"coveredBy":["26"],"location":{"end":{"column":6,"line":228},"start":{"column":61,"line":226}}},{"id":"173","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["26"],"location":{"end":{"column":69,"line":227},"start":{"column":35,"line":227}}},{"id":"174","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["26"],"location":{"end":{"column":67,"line":227},"start":{"column":46,"line":227}}},{"id":"175","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","28","29"],"location":{"end":{"column":42,"line":230},"start":{"column":9,"line":230}}},{"id":"176","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 200 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["28"],"coveredBy":["25","28","29"],"location":{"end":{"column":42,"line":230},"start":{"column":9,"line":230}}},{"id":"177","mutatorName":"EqualityOperator","replacement":"appointment.status === 'upcoming'","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","28","29"],"location":{"end":{"column":42,"line":230},"start":{"column":9,"line":230}}},{"id":"178","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","28","29"],"location":{"end":{"column":42,"line":230},"start":{"column":32,"line":230}}},{"id":"180","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string","status":"Killed","static":false,"testsCompleted":1,"killedBy":["28"],"coveredBy":["28"],"location":{"end":{"column":117,"line":231},"start":{"column":35,"line":231}}},{"id":"179","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 200 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["28"],"coveredBy":["28"],"location":{"end":{"column":6,"line":232},"start":{"column":44,"line":230}}},{"id":"181","mutatorName":"StringLiteral","replacement":"``","statusReason":"expected '' to contain 'Cannot cancel an appointment that is '","status":"Killed","static":false,"testsCompleted":1,"killedBy":["28"],"coveredBy":["28"],"location":{"end":{"column":115,"line":231},"start":{"column":46,"line":231}}},{"id":"182","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","29"],"location":{"end":{"column":37,"line":234},"start":{"column":26,"line":234}}},{"id":"184","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["25"],"location":{"end":{"column":61,"line":236},"start":{"column":25,"line":236}}},{"id":"183","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"Cannot read properties of undefined (reading 'status')","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25"],"location":{"end":{"column":76,"line":236},"start":{"column":14,"line":236}}},{"id":"186","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Server Error' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["29"],"coveredBy":["29"],"location":{"end":{"column":40,"line":239},"start":{"column":26,"line":239}}},{"id":"120","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":2,"line":215},"start":{"column":58,"line":136}}},{"id":"121","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["30"],"coveredBy":["30","31","32","33","34","46"],"location":{"end":{"column":4,"line":211},"start":{"column":7,"line":158}}},{"id":"189","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","36","37","38","39","40"],"location":{"end":{"column":37,"line":247},"start":{"column":7,"line":247}}},{"id":"190","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 403 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["36"],"coveredBy":["35","36","37","38","39","40"],"location":{"end":{"column":37,"line":247},"start":{"column":7,"line":247}}},{"id":"191","mutatorName":"EqualityOperator","replacement":"req.user.userType === 'doctor'","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","36","37","38","39","40"],"location":{"end":{"column":37,"line":247},"start":{"column":7,"line":247}}},{"id":"192","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","36","37","38","39","40"],"location":{"end":{"column":37,"line":247},"start":{"column":29,"line":247}}},{"id":"193","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 403 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["36"],"coveredBy":["36"],"location":{"end":{"column":4,"line":249},"start":{"column":39,"line":247}}},{"id":"194","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["36"],"location":{"end":{"column":76,"line":248},"start":{"column":33,"line":248}}},{"id":"195","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["36"],"location":{"end":{"column":74,"line":248},"start":{"column":44,"line":248}}},{"id":"197","mutatorName":"BooleanLiteral","replacement":"appointment","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","37","38","39","40"],"location":{"end":{"column":21,"line":253},"start":{"column":9,"line":253}}},{"id":"198","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","37","38","39","40"],"location":{"end":{"column":21,"line":253},"start":{"column":9,"line":253}}},{"id":"199","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["37"],"coveredBy":["35","37","38","39","40"],"location":{"end":{"column":21,"line":253},"start":{"column":9,"line":253}}},{"id":"200","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["37"],"coveredBy":["37"],"location":{"end":{"column":6,"line":255},"start":{"column":23,"line":253}}},{"id":"201","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Appointment not found' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["37"],"coveredBy":["37"],"location":{"end":{"column":71,"line":254},"start":{"column":35,"line":254}}},{"id":"202","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Appointment not found' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["37"],"coveredBy":["37"],"location":{"end":{"column":69,"line":254},"start":{"column":46,"line":254}}},{"id":"203","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","38","39","40"],"location":{"end":{"column":58,"line":256},"start":{"column":9,"line":256}}},{"id":"204","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 200 to be 403 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["38"],"coveredBy":["35","38","39","40"],"location":{"end":{"column":58,"line":256},"start":{"column":9,"line":256}}},{"id":"205","mutatorName":"EqualityOperator","replacement":"appointment.doctor.toString() === req.user.userId","statusReason":"expected 403 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","38","39","40"],"location":{"end":{"column":58,"line":256},"start":{"column":9,"line":256}}},{"id":"206","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 200 to be 403 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["38"],"coveredBy":["38"],"location":{"end":{"column":6,"line":258},"start":{"column":60,"line":256}}},{"id":"207","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Access denied. You are not assigned t' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["38"],"coveredBy":["38"],"location":{"end":{"column":106,"line":257},"start":{"column":35,"line":257}}},{"id":"208","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Access denied. You are not assigned t' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["38"],"coveredBy":["38"],"location":{"end":{"column":104,"line":257},"start":{"column":46,"line":257}}},{"id":"209","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","39","40"],"location":{"end":{"column":42,"line":260},"start":{"column":9,"line":260}}},{"id":"210","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 200 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["39"],"coveredBy":["35","39","40"],"location":{"end":{"column":42,"line":260},"start":{"column":9,"line":260}}},{"id":"211","mutatorName":"EqualityOperator","replacement":"appointment.status === 'upcoming'","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","39","40"],"location":{"end":{"column":42,"line":260},"start":{"column":9,"line":260}}},{"id":"212","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","39","40"],"location":{"end":{"column":42,"line":260},"start":{"column":32,"line":260}}},{"id":"157","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["34"],"coveredBy":["34"],"location":{"end":{"column":4,"line":214},"start":{"column":17,"line":211}}},{"id":"213","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 200 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["39"],"coveredBy":["39"],"location":{"end":{"column":6,"line":262},"start":{"column":44,"line":260}}},{"id":"214","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string","status":"Killed","static":false,"testsCompleted":1,"killedBy":["39"],"coveredBy":["39"],"location":{"end":{"column":119,"line":261},"start":{"column":35,"line":261}}},{"id":"215","mutatorName":"StringLiteral","replacement":"``","statusReason":"expected '' to contain 'Cannot complete an appointment that i'","status":"Killed","static":false,"testsCompleted":1,"killedBy":["39"],"coveredBy":["39"],"location":{"end":{"column":117,"line":261},"start":{"column":46,"line":261}}},{"id":"161","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","26","27","28","29"],"location":{"end":{"column":2,"line":241},"start":{"column":63,"line":220}}},{"id":"162","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["25"],"coveredBy":["25","26","27","28","29"],"location":{"end":{"column":4,"line":237},"start":{"column":7,"line":221}}},{"id":"216","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","40"],"location":{"end":{"column":37,"line":264},"start":{"column":26,"line":264}}},{"id":"217","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"Cannot read properties of undefined (reading 'status')","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35"],"location":{"end":{"column":86,"line":266},"start":{"column":14,"line":266}}},{"id":"218","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["35"],"location":{"end":{"column":71,"line":266},"start":{"column":25,"line":266}}},{"id":"220","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["40"],"location":{"end":{"column":48,"line":268},"start":{"column":19,"line":268}}},{"id":"221","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Server Error' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["40"],"coveredBy":["40"],"location":{"end":{"column":40,"line":269},"start":{"column":26,"line":269}}},{"id":"225","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":7,"coveredBy":["13","14","15","16","17","18","48"],"location":{"end":{"column":47,"line":276},"start":{"column":42,"line":276}}},{"id":"226","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":8,"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":46,"line":278},"start":{"column":17,"line":278}}},{"id":"227","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":8,"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":29,"line":279},"start":{"column":17,"line":279}}},{"id":"228","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":8,"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":26,"line":280},"start":{"column":17,"line":280}}},{"id":"229","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":8,"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":28,"line":281},"start":{"column":17,"line":281}}},{"id":"230","mutatorName":"BooleanLiteral","replacement":"doctorId","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":18,"line":284},"start":{"column":9,"line":284}}},{"id":"231","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":18,"line":284},"start":{"column":9,"line":284}}},{"id":"232","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 404 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":4,"killedBy":["16"],"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":18,"line":284},"start":{"column":9,"line":284}}},{"id":"233","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 404 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["16"],"coveredBy":["16"],"location":{"end":{"column":6,"line":286},"start":{"column":20,"line":284}}},{"id":"185","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["29"],"coveredBy":["29"],"location":{"end":{"column":4,"line":240},"start":{"column":17,"line":237}}},{"id":"234","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Doctor ID is required.' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["16"],"coveredBy":["16"],"location":{"end":{"column":72,"line":285},"start":{"column":35,"line":285}}},{"id":"235","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Doctor ID is required.' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["16"],"coveredBy":["16"],"location":{"end":{"column":70,"line":285},"start":{"column":46,"line":285}}},{"id":"188","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","36","37","38","39","40"],"location":{"end":{"column":2,"line":271},"start":{"column":65,"line":246}}},{"id":"236","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","17","18","41","48"],"location":{"end":{"column":31,"line":288},"start":{"column":9,"line":288}}},{"id":"237","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 200 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":4,"killedBy":["17"],"coveredBy":["13","14","15","17","18","41","48"],"location":{"end":{"column":31,"line":288},"start":{"column":9,"line":288}}},{"id":"239","mutatorName":"BooleanLiteral","replacement":"amount","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","17","18","41","48"],"location":{"end":{"column":16,"line":288},"start":{"column":9,"line":288}}},{"id":"238","mutatorName":"LogicalOperator","replacement":"!amount && amount <= 0","status":"Survived","static":false,"testsCompleted":7,"coveredBy":["13","14","15","17","18","41","48"],"location":{"end":{"column":31,"line":288},"start":{"column":9,"line":288}}},{"id":"240","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["13","14","15","18","41","48"],"location":{"end":{"column":31,"line":288},"start":{"column":20,"line":288}}},{"id":"242","mutatorName":"EqualityOperator","replacement":"amount > 0","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","18","41","48"],"location":{"end":{"column":31,"line":288},"start":{"column":20,"line":288}}},{"id":"241","mutatorName":"EqualityOperator","replacement":"amount < 0","status":"Survived","static":false,"testsCompleted":6,"coveredBy":["13","14","15","18","41","48"],"location":{"end":{"column":31,"line":288},"start":{"column":20,"line":288}}},{"id":"243","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 200 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["17"],"coveredBy":["17"],"location":{"end":{"column":6,"line":290},"start":{"column":33,"line":288}}},{"id":"244","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Valid amount is required.' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["17"],"coveredBy":["17"],"location":{"end":{"column":75,"line":289},"start":{"column":35,"line":289}}},{"id":"196","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["35"],"coveredBy":["35","37","38","39","40"],"location":{"end":{"column":4,"line":267},"start":{"column":7,"line":251}}},{"id":"245","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Valid amount is required.' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["17"],"coveredBy":["17"],"location":{"end":{"column":73,"line":289},"start":{"column":46,"line":289}}},{"id":"246","mutatorName":"BooleanLiteral","replacement":"doctor","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","18","41","48"],"location":{"end":{"column":16,"line":294},"start":{"column":9,"line":294}}},{"id":"247","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","18","41","48"],"location":{"end":{"column":16,"line":294},"start":{"column":9,"line":294}}},{"id":"249","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 200 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["15"],"coveredBy":["15"],"location":{"end":{"column":6,"line":296},"start":{"column":18,"line":294}}},{"id":"248","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 200 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":3,"killedBy":["15"],"coveredBy":["13","14","15","18","41","48"],"location":{"end":{"column":16,"line":294},"start":{"column":9,"line":294}}},{"id":"250","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["15"],"location":{"end":{"column":67,"line":295},"start":{"column":35,"line":295}}},{"id":"251","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["15"],"location":{"end":{"column":65,"line":295},"start":{"column":46,"line":295}}},{"id":"252","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected 'undefined' to be 'number' // Object.is equality","status":"Killed","static":false,"testsCompleted":4,"killedBy":["41"],"coveredBy":["13","14","18","41","48"],"location":{"end":{"column":6,"line":304},"start":{"column":21,"line":299}}},{"id":"253","mutatorName":"StringLiteral","replacement":"``","statusReason":"expected false to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":4,"killedBy":["41"],"coveredBy":["13","14","18","41","48"],"location":{"end":{"column":37,"line":302},"start":{"column":16,"line":302}}},{"id":"255","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","41"],"location":{"end":{"column":6,"line":315},"start":{"column":14,"line":310}}},{"id":"254","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["13","14","18","41","48"],"location":{"end":{"column":42,"line":306},"start":{"column":17,"line":306}}},{"id":"256","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"expected false to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","41"],"location":{"end":{"column":20,"line":311},"start":{"column":16,"line":311}}},{"id":"258","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":2,"coveredBy":["18","48"],"location":{"end":{"column":50,"line":318},"start":{"column":19,"line":318}}},{"id":"259","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be false // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["18"],"coveredBy":["18","48"],"location":{"end":{"column":6,"line":322},"start":{"column":26,"line":319}}},{"id":"260","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"expected true to be false // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["18"],"coveredBy":["18","48"],"location":{"end":{"column":21,"line":320},"start":{"column":16,"line":320}}},{"id":"261","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Failed to create payment order' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["18"],"coveredBy":["18","48"],"location":{"end":{"column":48,"line":321},"start":{"column":16,"line":321}}},{"id":"265","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":41,"line":338},"start":{"column":38,"line":338}}},{"id":"266","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":27,"line":340},"start":{"column":19,"line":340}}},{"id":"267","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":90,"line":340},"start":{"column":29,"line":340}}},{"id":"268","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":90,"line":340},"start":{"column":29,"line":340}}},{"id":"269","mutatorName":"LogicalOperator","replacement":"process.env.RAZORPAY_KEY_SECRET && 'your_razorpay_key_secret'","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":90,"line":340},"start":{"column":29,"line":340}}},{"id":"271","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":20,"line":342},"start":{"column":15,"line":342}}},{"id":"272","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":49,"line":344},"start":{"column":9,"line":344}}},{"id":"273","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["20"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":49,"line":344},"start":{"column":9,"line":344}}},{"id":"274","mutatorName":"EqualityOperator","replacement":"expectedSignature === razorpay_signature","statusReason":"expected 400 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":49,"line":344},"start":{"column":9,"line":344}}},{"id":"275","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 400 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["20"],"coveredBy":["20"],"location":{"end":{"column":6,"line":349},"start":{"column":51,"line":344}}},{"id":"276","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be 'Payment verification failed' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["20"],"coveredBy":["20"],"location":{"end":{"column":8,"line":348},"start":{"column":35,"line":345}}},{"id":"219","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["40"],"coveredBy":["40"],"location":{"end":{"column":4,"line":270},"start":{"column":17,"line":267}}},{"id":"277","mutatorName":"BooleanLiteral","replacement":"true","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["20"],"location":{"end":{"column":23,"line":346},"start":{"column":18,"line":346}}},{"id":"223","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":2,"line":324},"start":{"column":74,"line":274}}},{"id":"278","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Payment verification failed' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["20"],"coveredBy":["20"],"location":{"end":{"column":47,"line":347},"start":{"column":18,"line":347}}},{"id":"224","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["13"],"coveredBy":["13","14","15","16","17","18","41","48"],"location":{"end":{"column":4,"line":317},"start":{"column":7,"line":275}}},{"id":"279","mutatorName":"BooleanLiteral","replacement":"doctor","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","21","22","23","47","50"],"location":{"end":{"column":16,"line":353},"start":{"column":9,"line":353}}},{"id":"280","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","21","22","23","47","50"],"location":{"end":{"column":16,"line":353},"start":{"column":9,"line":353}}},{"id":"281","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":2,"killedBy":["21"],"coveredBy":["19","21","22","23","47","50"],"location":{"end":{"column":16,"line":353},"start":{"column":9,"line":353}}},{"id":"282","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected 500 to be 404 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["21"],"coveredBy":["21"],"location":{"end":{"column":6,"line":355},"start":{"column":18,"line":353}}},{"id":"283","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be false // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["21"],"coveredBy":["21"],"location":{"end":{"column":82,"line":354},"start":{"column":35,"line":354}}},{"id":"284","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"expected true to be false // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["21"],"coveredBy":["21"],"location":{"end":{"column":51,"line":354},"start":{"column":46,"line":354}}},{"id":"285","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Doctor not found' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["21"],"coveredBy":["21"],"location":{"end":{"column":80,"line":354},"start":{"column":62,"line":354}}},{"id":"286","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":6,"line":385},"start":{"column":41,"line":358}}},{"id":"287","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":47,"line":364},"start":{"column":17,"line":364}}},{"id":"288","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":47,"line":364},"start":{"column":17,"line":364}}},{"id":"290","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":47,"line":364},"start":{"column":45,"line":364}}},{"id":"291","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":69,"line":372},"start":{"column":28,"line":372}}},{"id":"289","mutatorName":"LogicalOperator","replacement":"appointmentData.symptoms && []","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":47,"line":364},"start":{"column":17,"line":364}}},{"id":"292","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":69,"line":372},"start":{"column":28,"line":372}}},{"id":"293","mutatorName":"LogicalOperator","replacement":"appointmentData.severeSymptomsCheck && []","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":69,"line":372},"start":{"column":28,"line":372}}},{"id":"294","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":69,"line":372},"start":{"column":67,"line":372}}},{"id":"295","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":73,"line":373},"start":{"column":30,"line":373}}},{"id":"296","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":73,"line":373},"start":{"column":30,"line":373}}},{"id":"297","mutatorName":"LogicalOperator","replacement":"appointmentData.preExistingConditions && []","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":73,"line":373},"start":{"column":30,"line":373}}},{"id":"298","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":73,"line":373},"start":{"column":71,"line":373}}},{"id":"299","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":57,"line":375},"start":{"column":22,"line":375}}},{"id":"300","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":57,"line":375},"start":{"column":22,"line":375}}},{"id":"301","mutatorName":"LogicalOperator","replacement":"appointmentData.familyHistory && []","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":57,"line":375},"start":{"column":22,"line":375}}},{"id":"302","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":57,"line":375},"start":{"column":55,"line":375}}},{"id":"303","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":28,"line":382},"start":{"column":22,"line":382}}},{"id":"305","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"expected 1 to be +0 // Object.is equality","status":"Killed","static":false,"testsCompleted":3,"killedBy":["23"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":60,"line":384},"start":{"column":33,"line":384}}},{"id":"306","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":60,"line":384},"start":{"column":33,"line":384}}},{"id":"304","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":25,"line":383},"start":{"column":15,"line":383}}},{"id":"307","mutatorName":"LogicalOperator","replacement":"doctor.consultationFee && 0","statusReason":"expected 500 to be 200 // Object.is equality","status":"Killed","static":false,"testsCompleted":3,"killedBy":["23"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":60,"line":384},"start":{"column":33,"line":384}}},{"id":"308","mutatorName":"StringLiteral","replacement":"``","statusReason":"expected '' to contain 'Dr. MailName'","status":"Killed","static":false,"testsCompleted":4,"killedBy":["47"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":6,"line":454},"start":{"column":23,"line":390}}},{"id":"309","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":112,"line":437},"start":{"column":24,"line":437}}},{"id":"310","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":112,"line":437},"start":{"column":24,"line":437}}},{"id":"311","mutatorName":"LogicalOperator","replacement":"process.env.CLIENT_URL && 'https://smart-healthcare-appointment-and-triage.onrender.com'","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":112,"line":437},"start":{"column":24,"line":437}}},{"id":"312","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":112,"line":437},"start":{"column":50,"line":437}}},{"id":"313","mutatorName":"BlockStatement","replacement":"{}","statusReason":"expected \"vi.fn()\" to be called with arguments: [ ObjectContaining{} ]\u001b[90m\n\nNumber of calls: \u001b[1m0\u001b[22m\n\u001b[39m","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":6,"line":462},"start":{"column":9,"line":456}}},{"id":"314","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected \"vi.fn()\" to be called with arguments: [ ObjectContaining{} ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st vi.fn() call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   ObjectContaining {\u001b[90m\n\u001b[32m-     \"email\": \"john@test.com\",\u001b[90m\n\u001b[32m-     \"subject\": StringContaining \"Payment Successful\",\u001b[90m\n\u001b[32m-   },\u001b[90m\n\u001b[31m+   {},\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m1\u001b[22m\n\u001b[39m","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":8,"line":461},"start":{"column":23,"line":457}}},{"id":"315","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected \"vi.fn()\" to be called with arguments: [ ObjectContaining{} ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st vi.fn() call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   ObjectContaining {\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[2m      \"email\": \"john@test.com\",\u001b[22m\n\u001b[32m-     \"subject\": StringContaining \"Payment Successful\",\u001b[90m\n\u001b[31m+     \"html\": \"\u001b[90m\n\u001b[31m+       <div style=\\\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9f9f9;\\\">\u001b[90m\n\u001b[31m+         <div style=\\\"background-color: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\\">\u001b[90m\n\u001b[31m+           <div style=\\\"text-align: center; margin-bottom: 30px;\\\">\u001b[90m\n\u001b[31m+             <h1 style=\\\"color: #16a34a; margin: 0; font-size: 28px;\\\"> Payment Successful!</h1>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+           \u001b[90m\n\u001b[31m+           <div style=\\\"margin-bottom: 25px;\\\">\u001b[90m\n\u001b[31m+             <h2 style=\\\"color: #333; margin-bottom: 15px;\\\">Dear John Doe,</h2>\u001b[90m\n\u001b[31m+             <p style=\\\"color: #666; line-height: 1.6; font-size: 16px;\\\">\u001b[90m\n\u001b[31m+               Thank you for your payment! Your appointment has been successfully confirmed with IntelliConsult.\u001b[90m\n\u001b[31m+             </p>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+           \u001b[90m\n\u001b[31m+           <div style=\\\"background-color: #f0fdf4; padding: 25px; border-radius: 10px; border: 2px solid #16a34a; margin: 25px 0;\\\">\u001b[90m\n\u001b[31m+             <h3 style=\\\"color: #166534; margin: 0 0 15px 0; font-size: 18px;\\\"> Appointment Details</h3>\u001b[90m\n\u001b[31m+             <div style=\\\"color: #333; line-height: 1.8;\\\">\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Doctor:</strong> Dr. Verify</p>\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Specialization:</strong> Cardiology</p>\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Date:</strong> Sat Nov 29 2025</p>\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Time:</strong> 10:00 AM</p>\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Amount Paid:</strong> 500</p>\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Payment ID:</strong> pay_123</p>\u001b[90m\n\u001b[31m+               <p style=\\\"margin: 8px 0;\\\"><strong> Status:</strong> <span style=\\\"color: #16a34a; font-weight: 600;\\\">Confirmed & Paid</span></p>\u001b[90m\n\u001b[31m+             </div>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+           \u001b[90m\n\u001b[31m+           <div style=\\\"background-color: #dbeafe; padding: 20px; border-radius: 8px; border-left: 4px solid #2563eb; margin: 25px 0;\\\">\u001b[90m\n\u001b[31m+             <p style=\\\"color: #1e40af; font-weight: 600; margin: 0; font-size: 16px;\\\">\u001b[90m\n\u001b[31m+                You will receive a video call link before your appointment time.\u001b[90m\n\u001b[31m+             </p>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+           \u001b[90m\n\u001b[31m+           <div style=\\\"margin: 25px 0;\\\">\u001b[90m\n\u001b[31m+             <p style=\\\"color: #666; line-height: 1.6;\\\">\u001b[90m\n\u001b[31m+               <strong>Preparation for your consultation:</strong>\u001b[90m\n\u001b[31m+             </p>\u001b[90m\n\u001b[31m+             <ul style=\\\"color: #666; line-height: 1.8; padding-left: 20px;\\\">\u001b[90m\n\u001b[31m+               <li>Have your medical history and current medications ready</li>\u001b[90m\n\u001b[31m+               <li>Prepare a list of questions you want to ask the doctor</li>\u001b[90m\n\u001b[31m+               <li>Ensure you have a stable internet connection</li>\u001b[90m\n\u001b[31m+               <li>Find a quiet, well-lit space for the video call</li>\u001b[90m\n\u001b[31m+               <li>Test your camera and microphone beforehand</li>\u001b[90m\n\u001b[31m+             </ul>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+           \u001b[90m\n\u001b[31m+           <div style=\\\"text-align: center; margin: 30px 0;\\\">\u001b[90m\n\u001b[31m+             <a href=\\\"https://smart-healthcare-appointment-and-triage.onrender.com/patient/dashboard\\\" \u001b[90m\n\u001b[31m+                style=\\\"background-color: #16a34a; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; font-weight: 600; display: inline-block; margin-right: 10px;\\\">\u001b[90m\n\u001b[31m+               View My Appointments\u001b[90m\n\u001b[31m+             </a>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+           \u001b[90m\n\u001b[31m+           <div style=\\\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; text-align: center;\\\">\u001b[90m\n\u001b[31m+             <p style=\\\"color: #9ca3af; font-size: 14px; margin: 0;\\\">\u001b[90m\n\u001b[31m+               If you need to reschedule or have any questions, please contact our support team.\u001b[90m\n\u001b[31m+             </p>\u001b[90m\n\u001b[31m+             <p style=\\\"color: #9ca3af; font-size: 14px; margin: 5px 0 0 0;\\\">\u001b[90m\n\u001b[31m+               Thank you for choosing IntelliConsult!<br>\u001b[90m\n\u001b[31m+               <strong>IntelliConsult Team</strong>\u001b[90m\n\u001b[31m+             </p>\u001b[90m\n\u001b[31m+           </div>\u001b[90m\n\u001b[31m+         </div>\u001b[90m\n\u001b[31m+       </div>\u001b[90m\n\u001b[31m+     \",\u001b[90m\n\u001b[31m+     \"subject\": \"\",\u001b[90m\n\u001b[2m    },\u001b[22m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m1\u001b[22m\n\u001b[39m","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":82,"line":459},"start":{"column":18,"line":459}}},{"id":"316","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["22"],"location":{"end":{"column":6,"line":465},"start":{"column":26,"line":462}}},{"id":"317","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["22"],"location":{"end":{"column":64,"line":463},"start":{"column":21,"line":463}}},{"id":"318","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":6,"line":471},"start":{"column":14,"line":467}}},{"id":"319","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"expected false to be true // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":20,"line":468},"start":{"column":16,"line":468}}},{"id":"322","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":1,"coveredBy":["24"],"location":{"end":{"column":48,"line":474},"start":{"column":19,"line":474}}},{"id":"323","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"expected undefined to be false // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["24"],"coveredBy":["24"],"location":{"end":{"column":6,"line":478},"start":{"column":26,"line":475}}},{"id":"320","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","static":false,"testsCompleted":5,"coveredBy":["19","22","23","47","50"],"location":{"end":{"column":70,"line":469},"start":{"column":16,"line":469}}},{"id":"325","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected '' to be 'Payment verification failed' // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["24"],"coveredBy":["24"],"location":{"end":{"column":45,"line":477},"start":{"column":16,"line":477}}},{"id":"324","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"expected true to be false // Object.is equality","status":"Killed","static":false,"testsCompleted":1,"killedBy":["24"],"coveredBy":["24"],"location":{"end":{"column":21,"line":476},"start":{"column":16,"line":476}}},{"id":"1","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":1,"killedBy":["0"],"coveredBy":[],"location":{"end":{"column":40,"line":18},"start":{"column":12,"line":18}}},{"id":"82","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":9,"killedBy":["8"],"coveredBy":[],"location":{"end":{"column":30,"line":98},"start":{"column":12,"line":98}}},{"id":"257","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["18"],"coveredBy":["18","48"],"location":{"end":{"column":4,"line":323},"start":{"column":19,"line":317}}},{"id":"100","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":11,"killedBy":["10"],"coveredBy":[],"location":{"end":{"column":21,"line":114},"start":{"column":12,"line":114}}},{"id":"0","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","static":true,"testsCompleted":55,"coveredBy":[],"location":{"end":{"column":2,"line":16},"start":{"column":31,"line":13}}},{"id":"119","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 201 // Object.is equality","status":"Killed","static":true,"testsCompleted":31,"killedBy":["30"],"coveredBy":[],"location":{"end":{"column":20,"line":136},"start":{"column":13,"line":136}}},{"id":"222","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":14,"killedBy":["13"],"coveredBy":[],"location":{"end":{"column":36,"line":274},"start":{"column":13,"line":274}}},{"id":"264","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":4,"line":473},"start":{"column":7,"line":328}}},{"id":"263","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["19"],"coveredBy":["19","20","21","22","23","24","47","50"],"location":{"end":{"column":2,"line":480},"start":{"column":68,"line":327}}},{"id":"160","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":26,"killedBy":["25"],"coveredBy":[],"location":{"end":{"column":25,"line":220},"start":{"column":12,"line":220}}},{"id":"187","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":36,"killedBy":["35"],"coveredBy":[],"location":{"end":{"column":27,"line":246},"start":{"column":12,"line":246}}},{"id":"262","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"expected 404 to be 200 // Object.is equality","status":"Killed","static":true,"testsCompleted":20,"killedBy":["19"],"coveredBy":[],"location":{"end":{"column":30,"line":327},"start":{"column":13,"line":327}}},{"id":"321","mutatorName":"BlockStatement","replacement":"{}","statusReason":"Test timed out in 30000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".","status":"Killed","static":false,"testsCompleted":1,"killedBy":["24"],"coveredBy":["24"],"location":{"end":{"column":4,"line":479},"start":{"column":19,"line":473}}}],"source":"const express = require('express');\nconst router = express.Router();\nconst Appointment = require('../models/Appointment');\nconst Doctor = require('../models/Doctor');\nconst authMiddleware = require('../middleware/auth');\nconst sendEmail = require('../utils/email_utils');\n\n// Import Razorpay\nconst Razorpay = require('razorpay');\nconst crypto = require('crypto');\n\n// Initialize Razorpay instance\nconst razorpay = new Razorpay({\n  key_id: process.env.RAZORPAY_KEY_ID,\n  key_secret: process.env.RAZORPAY_KEY_SECRET\n});\n\nrouter.get('/available-slots/:doctorId', authMiddleware, async (req, res) => {\n  try {\n    const { doctorId } = req.params;\n    const doctor = await Doctor.findById(doctorId);\n    if (!doctor) {\n      return res.status(404).json({ message: 'Doctor not found.' });\n    }\n\n    const bookedAppointments = await Appointment.find({\n      doctor: doctorId,\n      status: 'upcoming',\n    });\n\n    const bookedSlots = new Set();\n    bookedAppointments.forEach(apt => {\n      const dateTimeString = `${new Date(apt.date).toDateString()}_${apt.time}`;\n      bookedSlots.add(dateTimeString);\n    });\n\n    const blockedTimes = doctor.blockedTimes || [];\n\n    const availableSlots = [];\n    const slotDuration = 60; \n    const daysOfWeek = [\"sunday\", \"monday\", \"tuesday\", \"wednesday\", \"thursday\", \"friday\", \"saturday\"];\n    const today = new Date();\n\n    for (let i = 0; i < 14; i++) { \n      const date = new Date(today);\n      date.setDate(today.getDate() + i);\n      \n      const dayKey = daysOfWeek[date.getDay()];\n      const daySchedule = doctor.workingHours.get(dayKey);\n\n      if (daySchedule && daySchedule.enabled) {\n        const [startHour, startMin] = daySchedule.start.split(':').map(Number);\n        const [endHour, endMin] = daySchedule.end.split(':').map(Number);\n\n        const startTime = new Date(date.setHours(startHour, startMin, 0, 0));\n        const endTime = new Date(date.setHours(endHour, endMin, 0, 0));\n\n        let currentSlotTime = new Date(startTime);\n        while (currentSlotTime < endTime) {\n          const timeString = currentSlotTime.toLocaleTimeString('en-US', {\n            hour: '2-digit',\n            minute: '2-digit',\n            hour12: true\n          });\n          const dateString = currentSlotTime.toDateString();\n          const dateTimeString = `${dateString}_${timeString}`;\n          let isBlocked = false;\n          for (const block of blockedTimes) {\n            const blockDate = new Date(block.date).toDateString();\n            if (blockDate === dateString) {\n              const slotTime = currentSlotTime.toTimeString().substring(0, 5); // \"HH:MM\"\n              if (slotTime >= block.startTime && slotTime < block.endTime) {\n                isBlocked = true;\n                break;\n              }\n            }\n          }\n          if (!bookedSlots.has(dateTimeString) && !isBlocked) {\n            availableSlots.push({\n              date: currentSlotTime.toISOString().split('T')[0],\n              time: timeString\n            });\n          }\n          \n          currentSlotTime.setMinutes(currentSlotTime.getMinutes() + slotDuration);\n        }\n      }\n    }\n    res.json(availableSlots);\n  } catch (err) {\n    console.error(err.message);\n    res.status(500).send('Server Error');\n  }\n});\n// @route   GET api/appointments/my-appointments\n// @desc    Get all appointments for the logged-in patient\n// @access  Private (Patient only)\nrouter.get('/my-appointments', authMiddleware, async (req, res) => {\n  if (req.user.userType !== 'patient') {\n    return res.status(403).json({ message: 'Access denied. Not a patient.' });\n  }\n  try {\n    const appointments = await Appointment.find({ patient: req.user.userId })\n      .populate('doctor', 'fullName specialization')\n      .sort({ date: -1 });\n\n    res.json(appointments);\n  } catch (err) {\n    console.error(err.message);\n    res.status(500).send('Server Error');\n  }\n});\n\nrouter.get('/doctor', authMiddleware, async (req, res) => {\n  if (req.user.userType !== 'doctor') {\n    return res.status(403).json({ message: 'Access denied. Not a doctor.' });\n  }\n  try {\n    const appointments = await Appointment.find({ doctor: req.user.userId })\n      .populate('patient', 'fullName email') // Get patient details\n      .sort({ date: 1 });\n    \n    // Filter out appointments where patient is null (deleted patient references)\n    const validAppointments = appointments.filter(appointment => appointment.patient);\n    \n    res.json(validAppointments);\n  } catch (err) {\n    console.error(err.message);\n    res.status(500).send('Server Error');\n  }\n});\n\n// @route   POST api/appointments/book\n// @desc    Book a new appointment\n// @access  Private (Patient only)\nrouter.post('/book', authMiddleware, async (req, res) => {\n  console.log(req.body);\n  // 1. Destructure ALL fields from the body\n  const {\n    doctorId, date, time, patientNameForVisit,\n    // Triage fields\n    emergencyDisclaimerAcknowledged,\n    primaryReason,\n    symptomsList,\n    symptomsOther,\n    symptomsBegin,\n    severeSymptomsCheck,\n    preExistingConditions,\n    preExistingConditionsOther,\n    pastSurgeries,\n    familyHistory,\n    familyHistoryOther,\n    allergies,\n    medications,\n    consentToAI\n  } = req.body;\n\n  try {\n    // 2. Basic validation\n    if (!doctorId || !date || !time || !patientNameForVisit || !primaryReason) {\n      return res.status(400).json({ message: 'Missing required fields: doctor, date, time, patient name, or reason.' });\n    }\n\n    // 3. Check for double-bookings (race condition)\n    const existingAppointment = await Appointment.findOne({\n      doctor: doctorId,\n      date: new Date(date), \n      time: time,\n      status: 'upcoming'\n    });\n    if (existingAppointment) {\n      return res.status(409).json({ message: 'This time slot is no longer available. Please select another.' });\n    }\n\n    // 4. Fetch the doctor to get their fee\n    const doctor = await Doctor.findById(doctorId);\n    if (!doctor) {\n      return res.status(404).json({ message: 'Doctor not found.' });\n    }\n    const fee = doctor.consultationFee || 0; // Use default if fee is missing\n\n    // 5. Create new appointment with all fields\n    const newAppointment = new Appointment({\n      patient: req.user.userId,\n      doctor: doctorId,\n      date,\n      time,\n      patientNameForVisit,\n      consultationFeeAtBooking: fee,\n      paymentStatus: 'pending',\n      // Triage fields\n      emergencyDisclaimerAcknowledged,\n      primaryReason,\n      symptomsList,\n      symptomsOther,\n      symptomsBegin,\n      severeSymptomsCheck,\n      preExistingConditions,\n      preExistingConditionsOther,\n      pastSurgeries,\n      familyHistory,\n      familyHistoryOther,\n      allergies,\n      medications,\n      consentToAI\n    });\n\n    const appointment = await newAppointment.save();\n\n    res.status(201).json(appointment);\n  } catch (err) {\n    console.error('Booking Error:', err.message);\n    res.status(500).send('Server Error');\n  }\n});\n\n// @route   PUT api/appointments/:id/cancel\n// @desc    Cancel an appointment\n// @access  Private (Patient only)\nrouter.put('/:id/cancel', authMiddleware, async (req, res) => {\n  try {\n    const appointment = await Appointment.findById(req.params.id);\n    if (!appointment) {\n      return res.status(404).json({ message: 'Appointment not found' });\n    }\n    if (appointment.patient.toString() !== req.user.userId) {\n      return res.status(401).json({ message: 'User not authorized' });\n    }\n    // --- FIX: Add backticks for template literal ---\n    if (appointment.status !== 'upcoming') {\n      return res.status(400).json({ message: `Cannot cancel an appointment that is already ${appointment.status}.` });\n    }\n\n    appointment.status = 'cancelled';\n    await appointment.save();\n    res.json({ message: 'Appointment cancelled successfully', appointment });\n  } catch (err) {\n    console.error(err.message);\n    res.status(500).send('Server Error');\n  }\n});\n\n// @route   PUT api/appointments/:id/complete\n// @desc    Mark an appointment as completed\n// @access  Private (Doctor only)\nrouter.put('/:id/complete', authMiddleware, async (req, res) => {\n  if (req.user.userType !== 'doctor') {\n    return res.status(403).json({ message: 'Access denied. Not a doctor.' });\n  }\n\n  try {\n    const appointment = await Appointment.findById(req.params.id);\n    if (!appointment) {\n      return res.status(404).json({ message: 'Appointment not found' });\n    }\n    if (appointment.doctor.toString() !== req.user.userId) {\n      return res.status(403).json({ message: 'Access denied. You are not assigned to this appointment.' });\n    }\n    // --- FIX: Add backticks for template literal ---\n    if (appointment.status !== 'upcoming') {\n      return res.status(400).json({ message: `Cannot complete an appointment that is already ${appointment.status}.` });\n    }\n\n    appointment.status = 'completed';\n    await appointment.save();\n    res.json({ message: 'Appointment marked as completed successfully', appointment });\n  } catch (err) {\n    console.error('Complete Appointment Error:', err.message);\n    res.status(500).send('Server Error');\n  }\n});\n\n// Create payment order\nrouter.post('/create-payment-order', authMiddleware, async (req, res) => {\n  try {\n    const { doctorId, amount, currency = 'INR' } = req.body;\n    \n    console.log('Payment order request body:', req.body);\n    console.log('Doctor ID:', doctorId);\n    console.log('Amount:', amount);\n    console.log('Currency:', currency);\n\n    // Validate required fields\n    if (!doctorId) {\n      return res.status(400).json({ message: 'Doctor ID is required.' });\n    }\n    \n    if (!amount || amount <= 0) {\n      return res.status(400).json({ message: 'Valid amount is required.' });\n    }\n\n    // Validate doctor exists\n    const doctor = await Doctor.findById(doctorId);\n    if (!doctor) {\n      return res.status(404).json({ message: 'Doctor not found.' });\n    }\n\n    // Create Razorpay order\n    const options = {\n      amount: parseInt(amount), // Ensure amount is an integer in paisa\n      currency: currency,\n      receipt: `order_${Date.now()}`,\n      payment_capture: 1\n    };\n    \n    console.log('Razorpay order options:', options);\n\n    const order = await razorpay.orders.create(options);\n\n    res.json({\n      success: true,\n      orderId: order.id,\n      amount: order.amount,\n      currency: order.currency\n    });\n\n  } catch (error) {\n    console.error('Payment order creation error:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Failed to create payment order'\n    });\n  }\n});\n\n// Verify payment and book appointment\nrouter.post('/verify-payment', authMiddleware, async (req, res) => {\n  try {\n    const {\n      razorpay_order_id,\n      razorpay_payment_id,\n      razorpay_signature,\n      doctorId,\n      ...appointmentData\n    } = req.body;\n\n    // Verify payment signature\n    const body = razorpay_order_id + \"|\" + razorpay_payment_id;\n    const expectedSignature = crypto\n      .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET || 'your_razorpay_key_secret')\n      .update(body.toString())\n      .digest('hex');\n\n    if (expectedSignature !== razorpay_signature) {\n      return res.status(400).json({\n        success: false,\n        message: 'Payment verification failed'\n      });\n    }\n\n    // Get doctor's consultation fee\n    const doctor = await Doctor.findById(doctorId);\n    if (!doctor) {\n      return res.status(404).json({ success: false, message: 'Doctor not found' });\n    }\n\n    // Payment verified, now create appointment\n    const appointment = new Appointment({\n      patient: req.user.userId,\n      doctor: doctorId,\n      date: appointmentData.date,\n      time: appointmentData.time,\n      reasonForVisit: appointmentData.primaryReason,\n      symptoms: appointmentData.symptoms || [],\n      patientNameForVisit: appointmentData.patientNameForVisit,\n      phoneNumber: appointmentData.phoneNumber,\n      email: appointmentData.email,\n      birthDate: appointmentData.birthDate,\n      sex: appointmentData.sex,\n      primaryLanguage: appointmentData.primaryLanguage,\n      symptomsBegin: appointmentData.symptomsBegin,\n      severeSymptomsCheck: appointmentData.severeSymptomsCheck || [],\n      preExistingConditions: appointmentData.preExistingConditions || [],\n      pastSurgeries: appointmentData.pastSurgeries,\n      familyHistory: appointmentData.familyHistory || [],\n      allergies: appointmentData.allergies,\n      medications: appointmentData.medications,\n      consentToAI: appointmentData.consentToAI,\n      emergencyDisclaimerAcknowledged: appointmentData.emergencyDisclaimerAcknowledged,\n      paymentId: razorpay_payment_id,\n      orderId: razorpay_order_id,\n      paymentStatus: 'paid',\n      status: 'upcoming',\n      consultationFeeAtBooking: doctor.consultationFee || 0\n    });\n\n    await appointment.save();\n\n    // Send confirmation email to patient for paid appointment\n    const emailHtml = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"background-color: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);\">\n          <div style=\"text-align: center; margin-bottom: 30px;\">\n            <h1 style=\"color: #16a34a; margin: 0; font-size: 28px;\"> Payment Successful!</h1>\n          </div>\n          \n          <div style=\"margin-bottom: 25px;\">\n            <h2 style=\"color: #333; margin-bottom: 15px;\">Dear ${appointmentData.patientNameForVisit},</h2>\n            <p style=\"color: #666; line-height: 1.6; font-size: 16px;\">\n              Thank you for your payment! Your appointment has been successfully confirmed with IntelliConsult.\n            </p>\n          </div>\n          \n          <div style=\"background-color: #f0fdf4; padding: 25px; border-radius: 10px; border: 2px solid #16a34a; margin: 25px 0;\">\n            <h3 style=\"color: #166534; margin: 0 0 15px 0; font-size: 18px;\"> Appointment Details</h3>\n            <div style=\"color: #333; line-height: 1.8;\">\n              <p style=\"margin: 8px 0;\"><strong> Doctor:</strong> ${doctor.fullName}</p>\n              <p style=\"margin: 8px 0;\"><strong> Specialization:</strong> ${doctor.specialization}</p>\n              <p style=\"margin: 8px 0;\"><strong> Date:</strong> ${new Date(appointmentData.date).toDateString()}</p>\n              <p style=\"margin: 8px 0;\"><strong> Time:</strong> ${appointmentData.time}</p>\n              <p style=\"margin: 8px 0;\"><strong> Amount Paid:</strong> ${doctor.consultationFee}</p>\n              <p style=\"margin: 8px 0;\"><strong> Payment ID:</strong> ${razorpay_payment_id}</p>\n              <p style=\"margin: 8px 0;\"><strong> Status:</strong> <span style=\"color: #16a34a; font-weight: 600;\">Confirmed & Paid</span></p>\n            </div>\n          </div>\n          \n          <div style=\"background-color: #dbeafe; padding: 20px; border-radius: 8px; border-left: 4px solid #2563eb; margin: 25px 0;\">\n            <p style=\"color: #1e40af; font-weight: 600; margin: 0; font-size: 16px;\">\n               You will receive a video call link before your appointment time.\n            </p>\n          </div>\n          \n          <div style=\"margin: 25px 0;\">\n            <p style=\"color: #666; line-height: 1.6;\">\n              <strong>Preparation for your consultation:</strong>\n            </p>\n            <ul style=\"color: #666; line-height: 1.8; padding-left: 20px;\">\n              <li>Have your medical history and current medications ready</li>\n              <li>Prepare a list of questions you want to ask the doctor</li>\n              <li>Ensure you have a stable internet connection</li>\n              <li>Find a quiet, well-lit space for the video call</li>\n              <li>Test your camera and microphone beforehand</li>\n            </ul>\n          </div>\n          \n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${process.env.CLIENT_URL || 'https://smart-healthcare-appointment-and-triage.onrender.com'}/patient/dashboard\" \n               style=\"background-color: #16a34a; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; font-weight: 600; display: inline-block; margin-right: 10px;\">\n              View My Appointments\n            </a>\n          </div>\n          \n          <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; text-align: center;\">\n            <p style=\"color: #9ca3af; font-size: 14px; margin: 0;\">\n              If you need to reschedule or have any questions, please contact our support team.\n            </p>\n            <p style=\"color: #9ca3af; font-size: 14px; margin: 5px 0 0 0;\">\n              Thank you for choosing IntelliConsult!<br>\n              <strong>IntelliConsult Team</strong>\n            </p>\n          </div>\n        </div>\n      </div>\n    `;\n\n    try {\n      await sendEmail({\n        email: appointmentData.email,\n        subject: ' Payment Successful - Appointment Confirmed | IntelliConsult',\n        html: emailHtml\n      });\n    } catch (emailError) {\n      console.error('Error sending payment confirmation email:', emailError);\n      // Continue with the response even if email fails\n    }\n\n    res.json({\n      success: true,\n      message: 'Payment verified and appointment booked successfully',\n      appointment: appointment\n    });\n\n  } catch (error) {\n    console.error('Payment verification error:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Payment verification failed'\n    });\n  }\n});\n\nmodule.exports = router;\n\n"}},"schemaVersion":"1.0","thresholds":{"high":80,"low":60,"break":50},"testFiles":{"Test/appointments.test.js":{"tests":[{"id":"0","name":"Appointment Routes GET /available-slots/:doctorId should return available slots for a doctor"},{"id":"1","name":"Appointment Routes GET /available-slots/:doctorId should call Appointment.find with doctor and upcoming status (prevent mutation escape)"},{"id":"2","name":"Appointment Routes GET /available-slots/:doctorId should exclude booked slots from available slots (only upcoming blocks)"},{"id":"3","name":"Appointment Routes GET /available-slots/:doctorId should exclude blocked times from available slots (block window)"},{"id":"4","name":"Appointment Routes GET /available-slots/:doctorId should support workingHours stored as a Map (exercise .get(dayKey) path)"},{"id":"5","name":"Appointment Routes GET /available-slots/:doctorId should return 404 if doctor not found"},{"id":"6","name":"Appointment Routes GET /available-slots/:doctorId should handle server errors"},{"id":"7","name":"Appointment Routes GET /available-slots/:doctorId should handle errors when generating slots (Appointment.find throws)"},{"id":"8","name":"Appointment Routes GET /my-appointments should return appointments for logged-in patient"},{"id":"9","name":"Appointment Routes GET /my-appointments should deny access if user is not a patient"},{"id":"10","name":"Appointment Routes GET /my-appointments doctor endpoint should filter out appointments with null patient (mock Appointment.find return containing null patient)"},{"id":"11","name":"Appointment Routes GET /my-appointments should return appointments for logged-in doctor"},{"id":"12","name":"Appointment Routes GET /my-appointments should handle server errors for my-appointments (simulate Appointment.find chain rejection)"},{"id":"13","name":"Appointment Routes POST /create-payment-order should create a Razorpay order"},{"id":"14","name":"Appointment Routes POST /create-payment-order should call console.log lines in create-payment-order (exercise console.log coverage)"},{"id":"15","name":"Appointment Routes POST /create-payment-order should return 404 if doctor not found"},{"id":"16","name":"Appointment Routes POST /create-payment-order should return 400 if doctorId is missing"},{"id":"17","name":"Appointment Routes POST /create-payment-order should return 400 if amount is missing or invalid"},{"id":"18","name":"Appointment Routes POST /create-payment-order should handle Razorpay order creation errors"},{"id":"19","name":"Appointment Routes POST /verify-payment should verify payment signature and create appointment"},{"id":"20","name":"Appointment Routes POST /verify-payment should fail if signature is invalid"},{"id":"21","name":"Appointment Routes POST /verify-payment should return 404 if doctor not found during payment verification"},{"id":"22","name":"Appointment Routes POST /verify-payment should continue even if email sending fails"},{"id":"23","name":"Appointment Routes POST /verify-payment verify-payment should use default consultationFee 0 when doctor.consultationFee is missing (mocked doctor)"},{"id":"24","name":"Appointment Routes POST /verify-payment should handle general payment verification errors (Doctor.findById throws)"},{"id":"25","name":"Appointment Routes PUT /:id/cancel should cancel an upcoming appointment"},{"id":"26","name":"Appointment Routes PUT /:id/cancel should fail if user is not the owner"},{"id":"27","name":"Appointment Routes PUT /:id/cancel should return 404 if appointment not found"},{"id":"28","name":"Appointment Routes PUT /:id/cancel should fail if appointment is already cancelled"},{"id":"29","name":"Appointment Routes PUT /:id/cancel should handle server errors when cancelling appointment"},{"id":"30","name":"Appointment Routes POST /book should book an appointment successfully"},{"id":"31","name":"Appointment Routes POST /book should prevent double booking"},{"id":"32","name":"Appointment Routes POST /book should return 400 if required fields are missing"},{"id":"33","name":"Appointment Routes POST /book should return 404 if doctor not found"},{"id":"34","name":"Appointment Routes POST /book should handle server errors when booking appointment"},{"id":"35","name":"Appointment Routes PUT /:id/complete should mark appointment as completed by doctor"},{"id":"36","name":"Appointment Routes PUT /:id/complete should fail if user is not a doctor"},{"id":"37","name":"Appointment Routes PUT /:id/complete should return 404 if appointment not found"},{"id":"38","name":"Appointment Routes PUT /:id/complete should fail if doctor is not assigned to the appointment"},{"id":"39","name":"Appointment Routes PUT /:id/complete should fail if appointment is already completed"},{"id":"40","name":"Appointment Routes PUT /:id/complete should handle server errors when completing appointment"},{"id":"41","name":"Appointment Routes Extra mutation-killing tests create-payment-order should pass correct options to Razorpay (receipt & currency & amount)"},{"id":"42","name":"Appointment Routes Extra mutation-killing tests available-slots time string must include AM/PM (hour12 true behavior)"},{"id":"43","name":"Appointment Routes Extra mutation-killing tests available-slots date must be ISO yyyy-mm-dd (toISOString split behaviour)"},{"id":"44","name":"Appointment Routes Extra mutation-killing tests my-appointments patient endpoint should return appointments sorted descending by date"},{"id":"45","name":"Appointment Routes Extra mutation-killing tests doctor endpoint should return appointments sorted ascending by date"},{"id":"46","name":"Appointment Routes Extra mutation-killing tests book route should persist provided triage/extra fields"},{"id":"47","name":"Appointment Routes Extra mutation-killing tests verify-payment should include doctor name in email HTML (ensures email template includes doctor info)"},{"id":"48","name":"Appointment Routes Extra mutation-killing tests create-payment-order failure should log error and return expected json"},{"id":"49","name":"Appointment Routes Extra mutation-killing tests - round 2 doctor endpoint filters out appointments with null patient (mock Appointment.find)"},{"id":"50","name":"Appointment Routes Extra mutation-killing tests - round 2 verify-payment uses default consultationFee = 0 when Doctor.findById returns object without consultationFee (mock findById)"},{"id":"51","name":"Appointment Routes Extra mutation-killing tests - round 2 available-slots handles doctor.workingHours as a Map (force .get usage)"},{"id":"52","name":"Appointment Routes Extra mutation-killing tests - round 2 available-slots respects blockedTimes covering entire hour (boundary block)"},{"id":"53","name":"Appointment Routes Extra mutation-killing tests - round 2 doctor endpoint returns 500 on Appointment.find throwing (covers error path)"},{"id":"54","name":"Appointment Routes Extra mutation-killing tests - round 2 available-slots should exclude exact booked slot by matching dateTimeString string format"}],"source":"import { describe, it, expect, vi, beforeAll, afterAll, afterEach } from 'vitest';\n\nconst request = require('supertest');\nconst express = require('express');\nconst mongoose = require('mongoose');\nconst crypto = require('crypto');\nconst { MongoMemoryServer } = require('mongodb-memory-server');\n\n// Mock Razorpay BEFORE importing routes\nconst mockRazorpayInstance = {\n    orders: {\n        create: vi.fn().mockResolvedValue({\n            id: 'order_mock_123',\n            amount: 50000,\n            currency: 'INR'\n        })\n    }\n};\n\n// Mock email utils\nconst mockSendEmail = vi.fn().mockResolvedValue(true);\n\n// Mock auth middleware\nconst mockAuth = (req, res, next) => {\n    if (req.headers['mock-user']) {\n        req.user = JSON.parse(req.headers['mock-user']);\n        next();\n    } else {\n        res.status(401).json({ message: 'No token, authorization denied' });\n    }\n};\n\n// Override require for modules\nconst Module = require('module');\nconst originalRequire = Module.prototype.require;\nModule.prototype.require = function (id) {\n    if (id === '../middleware/auth') {\n        return mockAuth;\n    }\n    if (id === 'razorpay') {\n        // Return a constructor function\n        return function Razorpay() {\n            return mockRazorpayInstance;\n        };\n    }\n    if (id === '../utils/email_utils') {\n        return mockSendEmail;\n    }\n    return originalRequire.apply(this, arguments);\n};\n\n// Set environment variables before importing routes\nprocess.env.RAZORPAY_KEY_ID = 'test_key_id';\nprocess.env.RAZORPAY_KEY_SECRET = 'test_secret';\n\n// Import routes and models AFTER mocks are set up\nconst appointmentRoutes = require('../routes/appointments');\nconst Doctor = require('../models/Doctor');\nconst Patient = require('../models/Patient');\nconst Appointment = require('../models/Appointment');\n\nconst app = express();\napp.use(express.json());\napp.use('/api/appointments', appointmentRoutes);\n\nlet mongoServer;\n\nbeforeAll(async () => {\n    mongoServer = await MongoMemoryServer.create();\n    const uri = mongoServer.getUri();\n    await mongoose.connect(uri);\n}, 120000); // 2 minute timeout for MongoDB setup\n\nafterAll(async () => {\n    if (mongoose.connection.readyState !== 0) {\n        await mongoose.disconnect();\n    }\n    if (mongoServer) {\n        await mongoServer.stop();\n    }\n});\n\nafterEach(async () => {\n    await Doctor.deleteMany({});\n    await Patient.deleteMany({});\n    await Appointment.deleteMany({});\n    mockSendEmail.mockClear();\n    mockRazorpayInstance.orders.create.mockClear();\n    vi.restoreAllMocks();\n});\n\ndescribe('Appointment Routes', () => {\n\n    // --- 1. GET /api/appointments/available-slots/:doctorId ---\n    describe('GET /available-slots/:doctorId', () => {\n        it('should return available slots for a doctor', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Time',\n                email: 'time@test.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 10,\n                licenseNumber: 'LIC_TIME1',\n                address: '123 Time St',\n                consultationFee: 500,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"11:00\" },\n                    tuesday: { enabled: true, start: \"09:00\", end: \"11:00\" },\n                    wednesday: { enabled: true, start: \"09:00\", end: \"11:00\" },\n                    thursday: { enabled: true, start: \"09:00\", end: \"11:00\" },\n                    friday: { enabled: true, start: \"09:00\", end: \"11:00\" },\n                }\n            });\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(Array.isArray(res.body)).toBe(true);\n            expect(res.body.length).toBeGreaterThan(0);\n            expect(res.body[0]).toHaveProperty('date');\n            expect(res.body[0]).toHaveProperty('time');\n        });\n\n        it('should call Appointment.find with doctor and upcoming status (prevent mutation escape)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Spy',\n                email: 'spy@test.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 10,\n                licenseNumber: 'LIC_SPY1',\n                address: 'Spy St',\n                consultationFee: 500,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"10:00\" }\n                }\n            });\n\n            // spy on Appointment.find\n            const findSpy = vi.spyOn(Appointment, 'find');\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            // ensure Appointment.find was called with filter containing doctor id and status upcoming\n            expect(findSpy).toHaveBeenCalled();\n            const calledArgs = findSpy.mock.calls[0][0];\n            expect(calledArgs).toBeDefined();\n            expect(String(calledArgs.doctor)).toBe(String(doctor._id));\n            expect(calledArgs.status).toBe('upcoming');\n\n            findSpy.mockRestore();\n        });\n\n        it('should exclude booked slots from available slots (only upcoming blocks)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Booked',\n                email: 'booked@test.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 10,\n                licenseNumber: 'LIC_BOOK2',\n                address: '555 Booked St',\n                consultationFee: 500,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"12:00\" }\n                }\n            });\n\n            const tomorrow = new Date();\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            tomorrow.setHours(0, 0, 0, 0);\n\n            // upcoming appointment - should block the slot\n            await Appointment.create({\n                doctor: doctor._id,\n                patient: new mongoose.Types.ObjectId(),\n                date: tomorrow,\n                time: '10:00 AM',\n                status: 'upcoming',\n                consultationFeeAtBooking: 500,\n                patientNameForVisit: 'Booked Patient'\n            });\n\n            // completed appointment - should NOT block slot on the day after tomorrow\n            const dayAfter = new Date(tomorrow);\n            dayAfter.setDate(dayAfter.getDate() + 1);\n            dayAfter.setHours(0, 0, 0, 0);\n\n            await Appointment.create({\n                doctor: doctor._id,\n                patient: new mongoose.Types.ObjectId(),\n                date: dayAfter,\n                time: '09:00 AM',\n                status: 'completed',\n                consultationFeeAtBooking: 500,\n                patientNameForVisit: 'Completed Patient'\n            });\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            // The slot for 'tomorrow' at '10:00 AM' must be removed\n            const tomorrowDateString = tomorrow.toDateString();\n            const tomorrowSlots = res.body.filter(slot => new Date(slot.date).toDateString() === tomorrowDateString);\n            const blockedSlot = tomorrowSlots.find(slot => slot.time === '10:00 AM');\n            expect(blockedSlot).toBeUndefined();\n\n            // The completed appointment day should not be blocked (slot may exist on dayAfter)\n            const dayAfterSlots = res.body.filter(slot => new Date(slot.date).toDateString() === dayAfter.toDateString());\n            // If schedule allows 9:00, there should be a slot (we assert at least that array exists)\n            expect(dayAfterSlots).toBeDefined();\n        });\n\n        it('should exclude blocked times from available slots (block window)', async () => {\n            const tomorrow = new Date();\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            tomorrow.setHours(0, 0, 0, 0);\n\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Block',\n                email: 'block@test.com',\n                password: 'Secret@123',\n                specialization: 'Neurology',\n                experience: 8,\n                licenseNumber: 'LIC_BLOCK1',\n                address: '666 Block St',\n                consultationFee: 450,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"12:00\" }\n                },\n                blockedTimes: [\n                    {\n                        date: tomorrow,\n                        startTime: '10:00',\n                        endTime: '12:00',\n                        reason: 'Personal appointment'\n                    }\n                ]\n            });\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n\n            const tomorrowDateString = tomorrow.toDateString();\n            const tomorrowSlots = res.body.filter(slot =>\n                new Date(slot.date).toDateString() === tomorrowDateString\n            );\n\n            const blockedSlot1 = tomorrowSlots.find(slot => slot.time === '10:00 AM');\n            const blockedSlot2 = tomorrowSlots.find(slot => slot.time === '11:00 AM');\n            expect(blockedSlot1).toBeUndefined();\n            expect(blockedSlot2).toBeUndefined();\n        });\n\n        it('should support workingHours stored as a Map (exercise .get(dayKey) path)', async () => {\n            // Build a Map-like structure that Mongoose might give (simulate .get usage)\n            const workingHoursMap = new Map();\n            workingHoursMap.set('monday', { enabled: true, start: '09:00', end: '10:00' });\n\n            // Create doctor with required fields, store workingHours as plain object but we will mock findById to return a doc with Map\n            const real = await Doctor.create({\n                fullName: 'Dr. Map',\n                email: 'map@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 5,\n                licenseNumber: 'LIC_MAP1',\n                address: 'Map St',\n                consultationFee: 300,\n                workingHours: { monday: { enabled: true, start: '09:00', end: '10:00' } }\n            });\n\n            // Mock Doctor.findById to return an object where workingHours.get exists\n            const docLike = real.toObject();\n            docLike.workingHours = {\n                get: (key) => {\n                    return workingHoursMap.get(key);\n                }\n            };\n\n            const findDocSpy = vi.spyOn(Doctor, 'findById').mockResolvedValueOnce(docLike);\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${real._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.length).toBeGreaterThan(0);\n\n            findDocSpy.mockRestore();\n        });\n\n        it('should return 404 if doctor not found', async () => {\n            const fakeId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${fakeId}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(404);\n        });\n\n        it('should handle server errors', async () => {\n            vi.spyOn(Doctor, 'findById').mockImplementationOnce(() => {\n                throw new Error('Database error');\n            });\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n            const fakeId = new mongoose.Types.ObjectId();\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${fakeId}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(500);\n            expect(res.text).toBe('Server Error');\n        });\n\n        it('should handle errors when generating slots (Appointment.find throws)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Error',\n                email: 'error@test.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 10,\n                licenseNumber: 'LIC_ERROR1',\n                address: '123 Error St',\n                consultationFee: 500,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"11:00\" }\n                }\n            });\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            vi.spyOn(Appointment, 'find').mockImplementationOnce(() => { throw new Error('DB error during slots'); });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(500);\n            expect(res.text).toBe('Server Error');\n        });\n\n    });\n\n    // --- 2. GET /api/appointments/my-appointments ---\n    describe('GET /my-appointments', () => {\n        it('should return appointments for logged-in patient', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const doctor = await Doctor.create({\n                fullName: 'Dr. A',\n                email: 'a@t.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 5,\n                licenseNumber: 'LIC_APT1',\n                address: '111 Apt St',\n                consultationFee: 300,\n            });\n\n            await Appointment.create({\n                patient: patientId,\n                doctor: doctor._id,\n                date: new Date(),\n                time: '10:00 AM',\n                consultationFeeAtBooking: 300,\n                status: 'upcoming',\n                patientNameForVisit: 'Test Patient'\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/my-appointments')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.length).toBe(1);\n            expect(res.body[0].doctor.fullName).toBe('Dr. A');\n        });\n\n        it('should deny access if user is not a patient', async () => {\n            const mockUser = JSON.stringify({ userId: 'doc123', userType: 'doctor' });\n            const res = await request(app)\n                .get('/api/appointments/my-appointments')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(403);\n        });\n\n        it('doctor endpoint should filter out appointments with null patient (mock Appointment.find return containing null patient)', async () => {\n            const mockUser = JSON.stringify({ userId: 'docNull', userType: 'doctor' });\n\n            // Mock Appointment.find chain to return one appointment with patient = null\n            const mockFind = vi.spyOn(Appointment, 'find').mockImplementationOnce(() => {\n                return {\n                    populate: function () { return this; },\n                    sort: function () { return Promise.resolve([{ patient: null, _id: new mongoose.Types.ObjectId() }]); }\n                };\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/doctor')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(Array.isArray(res.body)).toBe(true);\n            expect(res.body.length).toBe(0);\n\n            mockFind.mockRestore();\n        });\n\n        it('should return appointments for logged-in doctor', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const patient = await Patient.create({\n                fullName: 'Patient Test',\n                email: 'patient_test@test.com',\n                password: 'Secret@123'\n            });\n\n            await Appointment.create({\n                patient: patient._id,\n                doctor: doctorId,\n                date: new Date(),\n                time: '02:00 PM',\n                consultationFeeAtBooking: 400,\n                status: 'upcoming',\n                patientNameForVisit: 'Patient Test'\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/doctor')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.length).toBe(1);\n            expect(res.body[0].patient.fullName).toBe('Patient Test');\n        });\n\n        it('should handle server errors for my-appointments (simulate Appointment.find chain rejection)', async () => {\n            vi.spyOn(Appointment, 'find').mockImplementationOnce(() => {\n                return {\n                    populate: vi.fn().mockReturnThis(),\n                    sort: vi.fn().mockRejectedValueOnce(new Error('Database error'))\n                };\n            });\n\n            const mockUser = JSON.stringify({ userId: 'patient123', userType: 'patient' });\n\n            const res = await request(app)\n                .get('/api/appointments/my-appointments')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(500);\n            expect(res.text).toBe('Server Error');\n        });\n    });\n\n    // --- 3. POST /api/appointments/create-payment-order ---\n    describe('POST /create-payment-order', () => {\n        it('should create a Razorpay order', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Pay',\n                email: 'pay@t.com',\n                password: 'Secret@123',\n                specialization: 'Dermatology',\n                experience: 7,\n                licenseNumber: 'LIC_PAY1',\n                address: '222 Pay St',\n                consultationFee: 500\n            });\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    amount: 50000 // in paisa\n                });\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.success).toBe(true);\n            expect(res.body.orderId).toBe('order_mock_123');\n            expect(mockRazorpayInstance.orders.create).toHaveBeenCalled();\n        });\n\n        it('should call console.log lines in create-payment-order (exercise console.log coverage)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Log',\n                email: 'log@t.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 4,\n                licenseNumber: 'LIC_LOG1',\n                address: 'Log St',\n                consultationFee: 200\n            });\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n\n            const logSpy = vi.spyOn(console, 'log').mockImplementation(() => { });\n\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    amount: 20000\n                });\n\n            expect(res.statusCode).toBe(200);\n            expect(logSpy).toHaveBeenCalled();\n\n            logSpy.mockRestore();\n        });\n\n        it('should return 404 if doctor not found', async () => {\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: new mongoose.Types.ObjectId(),\n                    amount: 500\n                });\n\n            expect(res.statusCode).toBe(404);\n        });\n\n        it('should return 400 if doctorId is missing', async () => {\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    amount: 50000\n                });\n\n            expect(res.statusCode).toBe(400);\n            expect(res.body.message).toBe('Doctor ID is required.');\n        });\n\n        it('should return 400 if amount is missing or invalid', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Invalid',\n                email: 'invalid@t.com',\n                password: 'Secret@123',\n                specialization: 'Dermatology',\n                experience: 7,\n                licenseNumber: 'LIC_INV1',\n                address: '333 Invalid St',\n                consultationFee: 500\n            });\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    amount: 0\n                });\n\n            expect(res.statusCode).toBe(400);\n            expect(res.body.message).toBe('Valid amount is required.');\n        });\n\n        it('should handle Razorpay order creation errors', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Error',\n                email: 'error@t.com',\n                password: 'Secret@123',\n                specialization: 'Dermatology',\n                experience: 7,\n                licenseNumber: 'LIC_ERR1',\n                address: '444 Error St',\n                consultationFee: 500\n            });\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n\n            mockRazorpayInstance.orders.create.mockRejectedValueOnce(new Error('Razorpay error'));\n\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    amount: 50000\n                });\n\n            expect(res.statusCode).toBe(500);\n            expect(res.body.success).toBe(false);\n            expect(res.body.message).toBe('Failed to create payment order');\n        });\n    });\n\n    // --- 4. POST /api/appointments/verify-payment ---\n    describe('POST /verify-payment', () => {\n        it('should verify payment signature and create appointment', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Verify',\n                email: 'v@t.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 10,\n                licenseNumber: 'LIC_VER1',\n                address: '123 Verify St',\n                consultationFee: 500\n            });\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_123' + '|' + 'pay_123')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_123',\n                    razorpay_payment_id: 'pay_123',\n                    razorpay_signature: expectedSignature,\n                    doctorId: doctor._id,\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'John Doe',\n                    primaryReason: 'Fever',\n                    email: 'john@test.com'\n                });\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.success).toBe(true);\n\n            const savedApt = await Appointment.findOne({ paymentId: 'pay_123' });\n            expect(savedApt).toBeTruthy();\n            expect(savedApt.paymentStatus).toBe('paid');\n\n            expect(mockSendEmail).toHaveBeenCalledWith(expect.objectContaining({\n                email: 'john@test.com',\n                subject: expect.stringContaining('Payment Successful')\n            }));\n        });\n\n        it('should fail if signature is invalid', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. V',\n                email: 'v2@t.com',\n                password: 'Secret@123',\n                specialization: 'Neurology',\n                experience: 8,\n                licenseNumber: 'LIC_VER2',\n                address: '456 Test St',\n                consultationFee: 400,\n            });\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_123',\n                    razorpay_payment_id: 'pay_123',\n                    razorpay_signature: 'invalid_signature_that_wont_match',\n                    doctorId: doctor._id,\n                    date: new Date().toISOString(),\n                    time: '11:00 AM',\n                    patientNameForVisit: 'Test User',\n                    primaryReason: 'Checkup',\n                    email: 'test@test.com'\n                });\n\n            expect(res.statusCode).toBe(400);\n            expect(res.body.message).toBe('Payment verification failed');\n        });\n\n        it('should return 404 if doctor not found during payment verification', async () => {\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_123' + '|' + 'pay_123')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_123',\n                    razorpay_payment_id: 'pay_123',\n                    razorpay_signature: expectedSignature,\n                    doctorId: new mongoose.Types.ObjectId(),\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'John Doe',\n                    primaryReason: 'Fever',\n                    email: 'john@test.com'\n                });\n\n            expect(res.statusCode).toBe(404);\n            expect(res.body.success).toBe(false);\n            expect(res.body.message).toBe('Doctor not found');\n        });\n\n        it('should continue even if email sending fails', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. EmailFail',\n                email: 'emailfail@t.com',\n                password: 'Secret@123',\n                specialization: 'Cardiology',\n                experience: 10,\n                licenseNumber: 'LIC_EMAIL1',\n                address: '789 Email St',\n                consultationFee: 500\n            });\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            mockSendEmail.mockRejectedValueOnce(new Error('Email service down'));\n\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_456' + '|' + 'pay_456')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_456',\n                    razorpay_payment_id: 'pay_456',\n                    razorpay_signature: expectedSignature,\n                    doctorId: doctor._id,\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'John Doe',\n                    primaryReason: 'Fever',\n                    email: 'john@test.com'\n                });\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.success).toBe(true);\n\n            const savedApt = await Appointment.findOne({ paymentId: 'pay_456' });\n            expect(savedApt).toBeTruthy();\n            expect(savedApt.paymentStatus).toBe('paid');\n        });\n\n        it('verify-payment should use default consultationFee 0 when doctor.consultationFee is missing (mocked doctor)', async () => {\n            const realDoctor = await Doctor.create({\n                fullName: 'Dr. NoFee',\n                email: 'nofee@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 5,\n                licenseNumber: 'LIC_NOFEE1',\n                address: 'No Fee St',\n                consultationFee: 250\n            });\n\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const doctorWithoutFee = { ...realDoctor.toObject() };\n            delete doctorWithoutFee.consultationFee;\n\n            const findSpy = vi.spyOn(Doctor, 'findById').mockResolvedValueOnce(doctorWithoutFee);\n\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_nofee' + '|' + 'pay_nofee')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_nofee',\n                    razorpay_payment_id: 'pay_nofee',\n                    razorpay_signature: expectedSignature,\n                    doctorId: realDoctor._id,\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'John Doe',\n                    primaryReason: 'Checkup',\n                    email: 'john@example.com'\n                });\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.success).toBe(true);\n\n            const saved = await Appointment.findOne({ paymentId: 'pay_nofee' });\n            expect(saved).toBeTruthy();\n            expect(saved.consultationFeeAtBooking).toBe(0);\n\n            findSpy.mockRestore();\n        });\n\n        it('should handle general payment verification errors (Doctor.findById throws)', async () => {\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n\n            vi.spyOn(Doctor, 'findById').mockImplementationOnce(() => { throw new Error('DB err'); });\n\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_789' + '|' + 'pay_789')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_789',\n                    razorpay_payment_id: 'pay_789',\n                    razorpay_signature: expectedSignature,\n                    doctorId: new mongoose.Types.ObjectId(),\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'John Doe',\n                    primaryReason: 'Fever',\n                    email: 'john@test.com'\n                });\n\n            expect(res.statusCode).toBe(500);\n            expect(res.body.success).toBe(false);\n            expect(res.body.message).toBe('Payment verification failed');\n        });\n    });\n\n    // --- 5. PUT /api/appointments/:id/cancel ---\n    describe('PUT /:id/cancel', () => {\n        it('should cancel an upcoming appointment', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const apt = await Appointment.create({\n                patient: patientId,\n                doctor: doctorId,\n                status: 'upcoming',\n                date: new Date(),\n                time: '09:00 AM',\n                consultationFeeAtBooking: 400,\n                patientNameForVisit: 'Cancel Patient'\n            });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/cancel`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.appointment.status).toBe('cancelled');\n        });\n\n        it('should fail if user is not the owner', async () => {\n            const otherPatientId = new mongoose.Types.ObjectId();\n            const doctorId = new mongoose.Types.ObjectId();\n            const apt = await Appointment.create({\n                patient: otherPatientId,\n                doctor: doctorId,\n                status: 'upcoming',\n                date: new Date(),\n                time: '10:00 AM',\n                consultationFeeAtBooking: 350,\n                patientNameForVisit: 'Other Patient'\n            });\n\n            const mockUser = JSON.stringify({ userId: 'myId', userType: 'patient' });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/cancel`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(401);\n        });\n\n        it('should return 404 if appointment not found', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const res = await request(app)\n                .put(`/api/appointments/${new mongoose.Types.ObjectId()}/cancel`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(404);\n            expect(res.body.message).toBe('Appointment not found');\n        });\n\n        it('should fail if appointment is already cancelled', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const apt = await Appointment.create({\n                patient: patientId,\n                doctor: doctorId,\n                status: 'cancelled',\n                date: new Date(),\n                time: '11:00 AM',\n                consultationFeeAtBooking: 400,\n                patientNameForVisit: 'Already Cancelled'\n            });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/cancel`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(400);\n            expect(res.body.message).toContain('Cannot cancel an appointment that is already cancelled');\n        });\n\n        it('should handle server errors when cancelling appointment', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const apt = await Appointment.create({\n                patient: patientId,\n                doctor: doctorId,\n                status: 'upcoming',\n                date: new Date(),\n                time: '12:00 PM',\n                consultationFeeAtBooking: 400,\n                patientNameForVisit: 'Error Cancel'\n            });\n\n            vi.spyOn(Appointment.prototype, 'save').mockImplementationOnce(() => { throw new Error('Database error'); });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/cancel`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(500);\n            expect(res.text).toBe('Server Error');\n        });\n    });\n\n    // --- 6. POST /api/appointments/book (Standard Booking) ---\n    describe('POST /book', () => {\n        it('should book an appointment successfully', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Book',\n                email: 'b@t.com',\n                password: 'Secret@123',\n                specialization: 'Orthopedics',\n                experience: 6,\n                licenseNumber: 'LIC_BOOK1',\n                address: '333 Book St',\n                consultationFee: 300\n            });\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/book')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    date: new Date().toISOString(),\n                    time: '02:00 PM',\n                    patientNameForVisit: 'Jane Doe',\n                    primaryReason: 'Checkup'\n                });\n\n            expect(res.statusCode).toBe(201);\n            expect(res.body.consultationFeeAtBooking).toBe(300);\n            expect(res.body.paymentStatus).toBe('pending');\n        });\n\n        it('should prevent double booking', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Busy',\n                email: 'busy@t.com',\n                password: 'Secret@123',\n                specialization: 'Pediatrics',\n                experience: 9,\n                licenseNumber: 'LIC_BUSY1',\n                address: '444 Busy St',\n                consultationFee: 450,\n            });\n            const date = new Date('2023-12-25');\n            const time = '10:00 AM';\n\n            await Appointment.create({\n                doctor: doctor._id,\n                patient: new mongoose.Types.ObjectId(),\n                date: date,\n                time: time,\n                status: 'upcoming',\n                consultationFeeAtBooking: 450,\n                patientNameForVisit: 'First Patient'\n            });\n\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/book')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    date: date.toISOString(),\n                    time: time,\n                    patientNameForVisit: 'Late Patient',\n                    primaryReason: 'Emergency'\n                });\n\n            expect(res.statusCode).toBe(409);\n            expect(res.body.message).toContain('no longer available');\n        });\n\n        it('should return 400 if required fields are missing', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/book')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: new mongoose.Types.ObjectId(),\n                    date: new Date().toISOString(),\n                    time: '02:00 PM',\n                    patientNameForVisit: 'Jane Doe'\n                });\n\n            expect(res.statusCode).toBe(400);\n            expect(res.body.message).toContain('Missing required fields');\n        });\n\n        it('should return 404 if doctor not found', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const res = await request(app)\n                .post('/api/appointments/book')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: new mongoose.Types.ObjectId(),\n                    date: new Date().toISOString(),\n                    time: '02:00 PM',\n                    patientNameForVisit: 'Jane Doe',\n                    primaryReason: 'Checkup'\n                });\n\n            expect(res.statusCode).toBe(404);\n            expect(res.body.message).toBe('Doctor not found.');\n        });\n\n        it('should handle server errors when booking appointment', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. ServerError',\n                email: 'servererror@t.com',\n                password: 'Secret@123',\n                specialization: 'Orthopedics',\n                experience: 6,\n                licenseNumber: 'LIC_SERR1',\n                address: '555 Error St',\n                consultationFee: 300\n            });\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const mockFindOne = vi.spyOn(Appointment, 'findOne').mockImplementationOnce(() => {\n                throw new Error('Database error');\n            });\n\n            const res = await request(app)\n                .post('/api/appointments/book')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    date: new Date().toISOString(),\n                    time: '02:00 PM',\n                    patientNameForVisit: 'Jane Doe',\n                    primaryReason: 'Checkup'\n                });\n\n            expect(res.statusCode).toBe(500);\n            expect(res.text).toBe('Server Error');\n\n            mockFindOne.mockRestore();\n        });\n    });\n\n    // --- 7. PUT /api/appointments/:id/complete ---\n    describe('PUT /:id/complete', () => {\n        it('should mark appointment as completed by doctor', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const apt = await Appointment.create({\n                doctor: doctorId,\n                patient: patientId,\n                status: 'upcoming',\n                date: new Date(),\n                time: '03:00 PM',\n                consultationFeeAtBooking: 500,\n                patientNameForVisit: 'Complete Patient'\n            });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/complete`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.appointment.status).toBe('completed');\n        });\n\n        it('should fail if user is not a doctor', async () => {\n            const mockUser = JSON.stringify({ userId: 'pat123', userType: 'patient' });\n            const res = await request(app)\n                .put(`/api/appointments/fake_id/complete`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(403);\n        });\n\n        it('should return 404 if appointment not found', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const res = await request(app)\n                .put(`/api/appointments/${new mongoose.Types.ObjectId()}/complete`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(404);\n            expect(res.body.message).toBe('Appointment not found');\n        });\n\n        it('should fail if doctor is not assigned to the appointment', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const otherDoctorId = new mongoose.Types.ObjectId();\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: otherDoctorId, userType: 'doctor' });\n\n            const apt = await Appointment.create({\n                doctor: doctorId,\n                patient: patientId,\n                status: 'upcoming',\n                date: new Date(),\n                time: '04:00 PM',\n                consultationFeeAtBooking: 500,\n                patientNameForVisit: 'Other Doctor Patient'\n            });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/complete`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(403);\n            expect(res.body.message).toBe('Access denied. You are not assigned to this appointment.');\n        });\n\n        it('should fail if appointment is already completed', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const apt = await Appointment.create({\n                doctor: doctorId,\n                patient: patientId,\n                status: 'completed',\n                date: new Date(),\n                time: '05:00 PM',\n                consultationFeeAtBooking: 500,\n                patientNameForVisit: 'Already Completed'\n            });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/complete`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(400);\n            expect(res.body.message).toContain('Cannot complete an appointment that is already completed');\n        });\n\n        it('should handle server errors when completing appointment', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const apt = await Appointment.create({\n                doctor: doctorId,\n                patient: patientId,\n                status: 'upcoming',\n                date: new Date(),\n                time: '04:00 PM',\n                consultationFeeAtBooking: 500,\n                patientNameForVisit: 'Error Patient'\n            });\n\n            vi.spyOn(Appointment.prototype, 'save').mockImplementationOnce(() => { throw new Error('Database error'); });\n\n            const res = await request(app)\n                .put(`/api/appointments/${apt._id}/complete`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(500);\n            expect(res.text).toBe('Server Error');\n        });\n    });\n\n    describe('Extra mutation-killing tests', () => {\n        it('create-payment-order should pass correct options to Razorpay (receipt & currency & amount)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Receipt',\n                email: 'receipt@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 3,\n                licenseNumber: 'LIC_REC1',\n                address: 'Receipt St',\n                consultationFee: 100\n            });\n            const mockUser = JSON.stringify({ userId: 'patReceipt', userType: 'patient' });\n\n            // Spy on orders.create and capture the passed options\n            const createSpy = mockRazorpayInstance.orders.create;\n            createSpy.mockClear();\n\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({\n                    doctorId: doctor._id,\n                    amount: 12345,\n                    currency: 'INR'\n                });\n\n            expect(res.statusCode).toBe(200);\n            expect(createSpy).toHaveBeenCalled();\n            const optionsArg = createSpy.mock.calls[0][0];\n            expect(optionsArg).toBeDefined();\n            expect(typeof optionsArg.amount).toBe('number');\n            expect(optionsArg.amount).toBe(12345);\n            expect(optionsArg.currency).toBe('INR');\n            expect(typeof optionsArg.receipt).toBe('string');\n            expect(optionsArg.receipt.startsWith('order_')).toBe(true);\n\n            createSpy.mockRestore && createSpy.mockRestore();\n        });\n\n        it('available-slots time string must include AM/PM (hour12 true behavior)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. AMPM',\n                email: 'ampm@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 2,\n                licenseNumber: 'LIC_AMPM1',\n                address: 'Ampm St',\n                consultationFee: 150,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"10:00\" }\n                }\n            });\n            const mockUser = JSON.stringify({ userId: 'p', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(Array.isArray(res.body)).toBe(true);\n            // Ensure at least one time contains AM or PM\n            const hasAmPm = res.body.some(s => /AM|PM/.test(String(s.time)));\n            expect(hasAmPm).toBe(true);\n        });\n\n        it('available-slots date must be ISO yyyy-mm-dd (toISOString split behaviour)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. ISO',\n                email: 'iso@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 2,\n                licenseNumber: 'LIC_ISO1',\n                address: 'Iso St',\n                consultationFee: 150,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"10:00\" }\n                }\n            });\n            const mockUser = JSON.stringify({ userId: 'piso', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(res.body.length).toBeGreaterThan(0);\n            expect(res.body.every(s => /^\\d{4}-\\d{2}-\\d{2}$/.test(String(s.date)))).toBe(true);\n        });\n\n        it('my-appointments patient endpoint should return appointments sorted descending by date', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Sort',\n                email: 'sort@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 4,\n                licenseNumber: 'LIC_SORT1',\n                address: 'Sort St',\n                consultationFee: 150\n            });\n\n            // create older then newer\n            const oldDate = new Date('2020-01-01');\n            const newDate = new Date('2022-01-01');\n\n            await Appointment.create({\n                patient: patientId,\n                doctor: doctor._id,\n                date: oldDate,\n                time: '10:00 AM',\n                status: 'upcoming',\n                consultationFeeAtBooking: 150,\n                patientNameForVisit: 'Old'\n            });\n\n            await Appointment.create({\n                patient: patientId,\n                doctor: doctor._id,\n                date: newDate,\n                time: '11:00 AM',\n                status: 'upcoming',\n                consultationFeeAtBooking: 150,\n                patientNameForVisit: 'New'\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/my-appointments')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            // Ensure the first item is the newer date\n            const returnedDates = res.body.map(a => new Date(a.date).getTime());\n            expect(returnedDates[0]).toBeGreaterThan(returnedDates[returnedDates.length - 1]);\n        });\n\n        it('doctor endpoint should return appointments sorted ascending by date', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const patient = await Patient.create({\n                fullName: 'Sort Patient',\n                email: 'sp@test.com',\n                password: 'Secret@123'\n            });\n\n            const day1 = new Date('2022-01-01');\n            const day2 = new Date('2023-01-01');\n\n            await Appointment.create({\n                patient: patient._id,\n                doctor: doctorId,\n                date: day2,\n                time: '10:00 AM',\n                consultationFeeAtBooking: 200,\n                status: 'upcoming',\n                patientNameForVisit: 'Later'\n            });\n\n            await Appointment.create({\n                patient: patient._id,\n                doctor: doctorId,\n                date: day1,\n                time: '09:00 AM',\n                consultationFeeAtBooking: 200,\n                status: 'upcoming',\n                patientNameForVisit: 'Earlier'\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/doctor')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            // ascending: earlier should come first\n            expect(new Date(res.body[0].date).getTime()).toBeLessThanOrEqual(new Date(res.body[1].date).getTime());\n        });\n\n        it('book route should persist provided triage/extra fields', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Triage',\n                email: 'triage@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 6,\n                licenseNumber: 'LIC_TRI1',\n                address: 'Triage St',\n                consultationFee: 350\n            });\n\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            const payload = {\n                doctorId: doctor._id,\n                date: new Date().toISOString(),\n                time: '03:00 PM',\n                patientNameForVisit: 'Triaged',\n                primaryReason: 'Symptoms',\n                emergencyDisclaimerAcknowledged: true,\n                symptomsList: ['cough', 'fever'],\n                preExistingConditions: ['hypertension'],\n                consentToAI: false\n            };\n\n            const res = await request(app)\n                .post('/api/appointments/book')\n                .set('mock-user', mockUser)\n                .send(payload);\n\n            expect(res.statusCode).toBe(201);\n            const created = await Appointment.findById(res.body._id);\n            expect(created).toBeTruthy();\n            expect(created.primaryReason).toBe('Symptoms');\n            expect(Array.isArray(created.symptomsList || created.symptoms)).toBe(true);\n        });\n\n        it('verify-payment should include doctor name in email HTML (ensures email template includes doctor info)', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. MailName',\n                email: 'mailname@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 6,\n                licenseNumber: 'LIC_MAIL1',\n                address: 'Mail St',\n                consultationFee: 400\n            });\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            // spy and capture html passed to sendEmail\n            const sendSpy = mockSendEmail;\n            sendSpy.mockClear();\n\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_mail' + '|' + 'pay_mail')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_mail',\n                    razorpay_payment_id: 'pay_mail',\n                    razorpay_signature: expectedSignature,\n                    doctorId: doctor._id,\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'Mailer',\n                    primaryReason: 'Check',\n                    email: 'mail@example.com'\n                });\n\n            expect(res.statusCode).toBe(200);\n            // ensure sendEmail called and its html includes the doctor's fullName\n            expect(sendSpy).toHaveBeenCalled();\n            const passedArg = sendSpy.mock.calls[0][0];\n            expect(passedArg).toBeDefined();\n            expect(String(passedArg.html || '')).toContain(doctor.fullName);\n        });\n\n        it('create-payment-order failure should log error and return expected json', async () => {\n            // make razorpay throw and ensure route returns the JSON failure object (covers console.error path)\n            const doctor = await Doctor.create({\n                fullName: 'Dr. PayFail',\n                email: 'payfail@test.com',\n                password: 'Secret@123',\n                specialization: 'General',\n                experience: 6,\n                licenseNumber: 'LIC_PAYF1',\n                address: 'PayFail St',\n                consultationFee: 400\n            });\n            const mockUser = JSON.stringify({ userId: 'pFail', userType: 'patient' });\n\n            // Make razorpay throw\n            mockRazorpayInstance.orders.create.mockRejectedValueOnce(new Error('boom'));\n\n            const errSpy = vi.spyOn(console, 'error').mockImplementation(() => { });\n\n            const res = await request(app)\n                .post('/api/appointments/create-payment-order')\n                .set('mock-user', mockUser)\n                .send({ doctorId: doctor._id, amount: 1000 });\n\n            expect(res.statusCode).toBe(500);\n            expect(res.body.success).toBe(false);\n            expect(res.body.message).toBe('Failed to create payment order');\n            expect(errSpy).toHaveBeenCalled();\n\n            errSpy.mockRestore();\n        });\n    });\n\n    describe('Extra mutation-killing tests - round 2', () => {\n        it('doctor endpoint filters out appointments with null patient (mock Appointment.find)', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const patient = await Patient.create({\n                fullName: 'Real Patient',\n                email: 'realp@test.com',\n                password: 'Secret@123'\n            });\n\n            const goodApt = {\n                _id: new mongoose.Types.ObjectId(),\n                patient: patient, // populated patient object (mongoose doc)\n                doctor: doctorId,\n                date: new Date(),\n                time: '09:00 AM',\n                consultationFeeAtBooking: 200,\n                status: 'upcoming',\n                patientNameForVisit: 'Real'\n            };\n\n            const nullApt = {\n                _id: new mongoose.Types.ObjectId(),\n                patient: null, // simulate deleted patient reference\n                doctor: doctorId,\n                date: new Date(),\n                time: '10:00 AM',\n                consultationFeeAtBooking: 200,\n                status: 'upcoming',\n                patientNameForVisit: 'Ghost'\n            };\n\n            // Mock Appointment.find to return a query-like object with populate().sort() chain\n            const populateMock = vi.fn().mockReturnThis();\n            const sortMock = vi.fn().mockResolvedValueOnce([nullApt, goodApt]);\n\n            const findSpy = vi.spyOn(Appointment, 'find').mockReturnValueOnce({\n                populate: populateMock,\n                sort: sortMock\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/doctor')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(Array.isArray(res.body)).toBe(true);\n            // Should filter out the null patient and return only the good one\n            expect(res.body.every(a => a.patient)).toBe(true);\n            expect(res.body.some(a => a.patient.fullName === 'Real Patient')).toBe(true);\n\n            findSpy.mockRestore();\n        });\n\n\n        it('verify-payment uses default consultationFee = 0 when Doctor.findById returns object without consultationFee (mock findById)', async () => {\n            const patientId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: patientId, userType: 'patient' });\n\n            // mock doctor plain object without consultationFee but with fullName\n            const fakeDoctor = {\n                _id: new mongoose.Types.ObjectId(),\n                fullName: 'No Fee Doctor',\n                specialization: 'None'\n                // no consultationFee property\n            };\n\n            const findDocSpy = vi.spyOn(Doctor, 'findById').mockResolvedValueOnce(fakeDoctor);\n\n            const expectedSignature = crypto\n                .createHmac('sha256', process.env.RAZORPAY_KEY_SECRET)\n                .update('order_def' + '|' + 'pay_def')\n                .digest('hex');\n\n            const res = await request(app)\n                .post('/api/appointments/verify-payment')\n                .set('mock-user', mockUser)\n                .send({\n                    razorpay_order_id: 'order_def',\n                    razorpay_payment_id: 'pay_def',\n                    razorpay_signature: expectedSignature,\n                    doctorId: fakeDoctor._id,\n                    date: new Date().toISOString(),\n                    time: '10:00 AM',\n                    patientNameForVisit: 'NoFee',\n                    primaryReason: 'Check',\n                    email: 'nofee@test.com'\n                });\n\n            expect(res.statusCode).toBe(200);\n            // Confirm appointment created with consultationFeeAtBooking defaulted to 0\n            const saved = await Appointment.findOne({ paymentId: 'pay_def' });\n            expect(saved).toBeTruthy();\n            expect(saved.consultationFeeAtBooking).toBe(0);\n\n            findDocSpy.mockRestore();\n        });\n\n        it('available-slots handles doctor.workingHours as a Map (force .get usage)', async () => {\n            const docObj = {\n                fullName: 'Dr. Map',\n                email: 'map@test.com',\n                password: 'Secret@123',\n                specialization: 'Test',\n                experience: 1,\n                licenseNumber: 'LIC_MAP1',\n                address: 'Map St',\n                consultationFee: 100\n            };\n            // Create doctor then convert workingHours into Map and save\n            let doctor = await Doctor.create(docObj);\n\n            // build map and attach then save doc directly via mongoose document\n            const wh = new Map();\n            wh.set('monday', { enabled: true, start: '09:00', end: '10:00' });\n            doctor.workingHours = wh;\n            await doctor.save();\n\n            const mockUser = JSON.stringify({ userId: 'pmap', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            expect(Array.isArray(res.body)).toBe(true);\n            // at least one slot should be returned for the configured day(s)\n            expect(res.body.length).toBeGreaterThanOrEqual(0);\n        });\n\n        it('available-slots respects blockedTimes covering entire hour (boundary block)', async () => {\n            // create tomorrow's date at midnight\n            const tomorrow = new Date();\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            tomorrow.setHours(0, 0, 0, 0);\n\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Boundary',\n                email: 'boundary@test.com',\n                password: 'Secret@123',\n                specialization: 'Test',\n                experience: 2,\n                licenseNumber: 'LIC_BOUND1',\n                address: 'Boundary St',\n                consultationFee: 120,\n                workingHours: {\n                    [(new Date()).toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase()]: { enabled: true, start: \"09:00\", end: \"10:00\" },\n                    // fallback won't break code  route still checks by dayKey\n                    monday: { enabled: true, start: \"09:00\", end: \"10:00\" }\n                },\n                blockedTimes: [\n                    {\n                        date: tomorrow,\n                        startTime: '09:00',\n                        endTime: '10:00',\n                        reason: 'All day block'\n                    }\n                ]\n            });\n\n            const mockUser = JSON.stringify({ userId: 'pbound', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            // Because the only slot is blocked, ensure that no slot at 9:00 AM is present for the blocked date\n            const blockedDateStr = tomorrow.toDateString();\n            const slotsOnBlockedDate = res.body.filter(s => new Date(s.date).toDateString() === blockedDateStr);\n            const nineAM = slotsOnBlockedDate.find(s => /9:00/.test(String(s.time)));\n            expect(nineAM).toBeUndefined();\n        });\n\n        it('doctor endpoint returns 500 on Appointment.find throwing (covers error path)', async () => {\n            const doctorId = new mongoose.Types.ObjectId();\n            const mockUser = JSON.stringify({ userId: doctorId, userType: 'doctor' });\n\n            const findSpy = vi.spyOn(Appointment, 'find').mockImplementationOnce(() => {\n                throw new Error('DB boom');\n            });\n\n            const res = await request(app)\n                .get('/api/appointments/doctor')\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(500);\n            findSpy.mockRestore();\n        });\n\n        it('available-slots should exclude exact booked slot by matching dateTimeString string format', async () => {\n            const doctor = await Doctor.create({\n                fullName: 'Dr. Exact',\n                email: 'exact@test.com',\n                password: 'Secret@123',\n                specialization: 'Test',\n                experience: 2,\n                licenseNumber: 'LIC_EXACT1',\n                address: 'Exact St',\n                consultationFee: 150,\n                workingHours: {\n                    monday: { enabled: true, start: \"09:00\", end: \"11:00\" }\n                }\n            });\n\n            // create an upcoming appointment that should match the dateTimeString format produced by the code\n            const tomorrow = new Date();\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            tomorrow.setHours(9, 0, 0, 0);\n\n            // time string should match toLocaleTimeString('en-US', {hour:'2-digit',minute:'2-digit',hour12:true}) output\n            const timeString = new Date(tomorrow).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });\n\n            await Appointment.create({\n                doctor: doctor._id,\n                patient: new mongoose.Types.ObjectId(),\n                date: tomorrow,\n                time: timeString,\n                status: 'upcoming',\n                consultationFeeAtBooking: 150,\n                patientNameForVisit: 'ExactBooked'\n            });\n\n            const mockUser = JSON.stringify({ userId: 'pExact', userType: 'patient' });\n\n            const res = await request(app)\n                .get(`/api/appointments/available-slots/${doctor._id}`)\n                .set('mock-user', mockUser);\n\n            expect(res.statusCode).toBe(200);\n            // The exact booked time should not be present\n            const slotsForTomorrow = res.body.filter(s => new Date(s.date).toDateString() === tomorrow.toDateString());\n            const exactSlot = slotsForTomorrow.find(s => s.time === timeString);\n            expect(exactSlot).toBeUndefined();\n        });\n    });\n\n});\n"}},"projectRoot":"/Users/kavysanghani/Desktop/SE_FINAL_PROJECT/Smart_Healthcare_Appointment_And_Triage_System/server","config":{"_comment":"This config was generated using 'stryker init'. Please take a look at: https://stryker-mutator.io/docs/stryker-js/configuration/ for more information.","packageManager":"npm","reporters":["html","clear-text","progress","json"],"testRunner":"vitest","coverageAnalysis":"off","mutate":["routes/appointments.js"],"vitest":{"configFile":"vitest.config.js","related":false},"disableTypeChecks":"{test,spec,routes}/**/*.{js,ts}","timeoutMS":120000,"timeoutFactor":3,"thresholds":{"high":80,"low":60,"break":50},"ignorePatterns":["dist","coverage",".git","node_modules"],"allowConsoleColors":true,"checkers":[],"checkerNodeArgs":[],"commandRunner":{"command":"npm test"},"clearTextReporter":{"allowColor":true,"allowEmojis":false,"logTests":true,"maxTestsToLog":3,"reportTests":true,"reportMutants":true,"reportScoreTable":true,"skipFull":false},"dashboard":{"baseUrl":"https://dashboard.stryker-mutator.io/api/reports","reportType":"full"},"dryRunOnly":false,"eventReporter":{"baseDir":"reports/mutation/events"},"ignoreStatic":false,"incremental":false,"incrementalFile":"reports/stryker-incremental.json","force":false,"fileLogLevel":"off","inPlace":false,"logLevel":"info","maxConcurrentTestRunners":9007199254740991,"maxTestRunnerReuse":0,"mutator":{"plugins":null,"excludedMutations":[]},"plugins":["@stryker-mutator/*"],"appendPlugins":[],"htmlReporter":{"fileName":"reports/mutation/mutation.html"},"jsonReporter":{"fileName":"reports/mutation/mutation.json"},"symlinkNodeModules":true,"tempDirName":".stryker-tmp","cleanTempDir":true,"testRunnerNodeArgs":[],"dryRunTimeoutMinutes":5,"tsconfigFile":"tsconfig.json","warnings":true,"disableBail":false,"allowEmpty":false,"ignorers":[]},"framework":{"name":"StrykerJS","version":"9.4.0","branding":{"homepageUrl":"https://stryker-mutator.io","imageUrl":"data:image/svg+xml;utf8,%3Csvg viewBox='0 0 1458 1458' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2'%3E%3Cpath fill='none' d='M0 0h1458v1458H0z'/%3E%3CclipPath id='a'%3E%3Cpath d='M0 0h1458v1458H0z'/%3E%3C/clipPath%3E%3Cg clip-path='url(%23a)'%3E%3Cpath d='M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729' fill='%23e74c3c' fill-rule='nonzero'/%3E%3Cpath d='M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z' fill-opacity='.3'/%3E%3Cpath d='M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z' fill='%23f1c40f' fill-rule='nonzero'/%3E%3Cpath d='M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z'/%3E%3C/g%3E%3C/svg%3E"},"dependencies":{"@stryker-mutator/jest-runner":"9.3.0","jest":"30.2.0"}}}